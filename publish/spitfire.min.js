var SPITFIRE=SPITFIRE||{};var $s=$s||SPITFIRE;SPITFIRE.browser={Opera:window.opera?true:false,IE:document.all&&!this.Opera?true:false,IE6:this.IE&&typeof(window.XMLHttpRequest)==="undefined"?true:false,IE8:this.IE&&typeof(document.querySelectorAll)!=="undefined"?true:false,IE7:this.IE&&!this.IE6&&!this.IE8?true:false,WebKit:/WebKit/i.test(navigator.userAgent)?true:false,iPhone:/iPhone|iPod/i.test(navigator.userAgent)?true:false,Chrome:/Chrome/i.test(navigator.userAgent)?true:false,Safari:/Safari/i.test(navigator.userAgent)&&!this.Chrome?true:false,Konqueror:navigator.vendor==="KDE"?true:false,Konqueror4:this.Konqueror&&/native code/.test(document.getElementsByClassName)?true:false,Gecko:!this.WebKit&&navigator.product==="Gecko"?true:false,Gecko19:this.Gecko&&Array.reduce?true:false};SPITFIRE.isArray=function(a){return typeof a==="object"&&a.length};SPITFIRE.isFunction=function(a){return typeof a==="function"};SPITFIRE.isWindow=function(a){return a&&typeof a==="object"&&"setInterval" in a};SPITFIRE.isPlainObject=function(b){if(!b||typeof b!=="object"||b.nodeType||SPITFIRE.isWindow(b)){return false}if(b.constructor&&!hasOwn.call(b,"constructor")&&!hasOwn.call(b.constructor.prototype,"isPrototypeOf")){return false}var a;for(a in b){}return a===undefined||hasOwn.call(b,a)};SPITFIRE.isSynthesizedProperty=function(f,c){var b=c.synthesizedProperties,e=false;if(b){var d,a;for(d=0,a=b.length;d<a;d+=1){if(b[d]===f){e=true;break}}}return e};SPITFIRE.objectHasMethod=function(a,b){return a!==null&&a[b]!==undefined&&SPITFIRE.isFunction(a[b])};SPITFIRE.slice=function(e,d,c){var a=[],b;for(b=d;b<=c;b+=1){a.push(e[b])}return a};SPITFIRE.extend=function(){var m,c,a,b,h,k,g=arguments[0]||{},f=1,d=arguments.length,l=false,j,e;if(typeof g==="boolean"){l=g;g=arguments[1]||{};f=2}if(typeof g!=="object"&&!SPITFIRE.isFunction(g)){g={}}if(d===f){g=this;--f}for(;f<d;f++){if((m=arguments[f])!=null){for(c in m){a=g[c];b=m[c];if(g===b){continue}if(l&&b&&(SPITFIRE.isPlainObject(b)||(h=SPITFIRE.isArray(b)))){if(h){h=false;k=a&&SPITFIRE.isArray(a)?a:[]}else{k=a&&SPITFIRE.isPlainObject(a)?a:{}}g[c]=SPITFIRE.extend(l,k,b)}else{if(b!==undefined){g[c]=b}}}}}return g};SPITFIRE.addListener=function(d,c,b,a){a=a||d;if(SPITFIRE.browser.IE){d.attachEvent("on"+c,b.context(a))}else{d.addEventListener(c,b.context(a),false)}};SPITFIRE.removeListener=function(d,c,b,a){a=a||d;if(SPITFIRE.browser.IE){d.detachEvent("on"+c,b.context(a))}else{d.removeEventListener(c,b.context(a),false)}};SPITFIRE.extendDOM=function(a){var b=$(a);SPITFIRE.extendChildren(b)};SPITFIRE.extendChildren=function(e){var n=e.filter("[sf-base]");var b=e.children();var h,l;for(h=0,l=b.length;h<l;h+=1){SPITFIRE.extendChildren($(b[h]))}if(n.length){var a=n[0];var m=a.getAttribute("sf-base");var f=m.split(".");var d,g,c;g=window;for(d=0,c=f.length;d<c;d+=1){g=g[f[d]]}if(!g){throw new SPITFIRE.Error("base class not found")}var k=new g();SPITFIRE.extend(a,k);a.init()}};if(!Array.indexOf){Array.prototype.indexOf=function(c){for(var b=0,a=this.length;b<a;b+=1){if(this[b]==c){return b}}return -1}}if(typeof Object.create!=="function"){Object.create=function(b){function a(){}a.prototype=b;return new a()}}Function.prototype.context=function(a){var b=this;temp=function(){return b.apply(a,arguments)};return temp};window.log=function(){log.history=log.history||[];log.history.push(arguments);arguments.callee=arguments.callee.caller;if(this.console){console.log(Array.prototype.slice.call(arguments))}};(function(e){function h(){}for(var g="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),f;f=g.pop();){e[f]=e[f]||h}})(window.console=window.console||{});SPITFIRE.Class=function(o){var b={},d=0,l,h,n,e,k,a,f;f=o.prototype;for(a in f){if(SPITFIRE.isFunction(f[a])){f[a]._class=o;f[a]._name=a}}if("superclass" in o){h=o.superclass;if(!h.isInitialized){SPITFIRE.Class(h)}b=SPITFIRE.extend(b,h.prototype)}b=SPITFIRE.extend(b,o.prototype);var j=function(i,p){return i+p.charAt(0).toUpperCase()+p.slice(1)};o.synthesizedProperties=o.synthesizedProperties||[];var m=function(i){return function(){return this["_"+i]}};var c=function(i){return function(p){this["_"+i]=p;return this}};var g=function(p,i){return function(){if(arguments.length>0){return this[i].apply(this,arguments)}else{return this[p]()}}};for(d=0,l=o.synthesizedProperties.length;d<l;d+=1){k=o.synthesizedProperties[d];if(k in b){throw ("property: "+k+" has already been synthesized in "+o);continue}n=j("get",k);e=j("set",k);if(!(n in b)){b[n]=m(k)}if(!(e in b)){b[e]=c(k)}b[k]=g(n,e)}o.prototype=b;o.isInitialized=true};SPITFIRE.Object=function(){this.qualifiedClassName("SPITFIRE.Object")};SPITFIRE.Object.synthesizedProperties=["qualifiedClassName"];SPITFIRE.Object.prototype={init:function(){},callSuper:function(){var b=SPITFIRE.Object.prototype.callSuper.caller;if(SPITFIRE.objectHasMethod(b,"superclass")){b.superclass.apply(this,arguments)}else{var c=b._class.superclass.prototype;var a=b._name;if(SPITFIRE.objectHasMethod(c,a)){return c[a].apply(this,arguments)}}}};SPITFIRE.Class(SPITFIRE.Object);SPITFIRE.Error=function(a){this.callSuper();this.message(a);this.name("Error");this.qualifiedClassName("SPITFIRE.Error")};SPITFIRE.Error.superclass=SPITFIRE.Object;SPITFIRE.Error.synthesizedProperties=["message","name"];SPITFIRE.Error.prototype={toString:function(){return this.name()+": ["+this.qualifiedClassName()+'] "'+this.message()+'"'}};SPITFIRE.Class(SPITFIRE.Error);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.Event=function(c,d,b,a){this.bubbles(b||false);this.cancelable(a||false);this.data(d||{});this.type(c)};SPITFIRE.events.Event.COMPLETE="complete";SPITFIRE.events.Event.CHANGE="change";SPITFIRE.events.Event.synthesizedProperties=["bubbles","cancelable","data","target","type"];SPITFIRE.events.Event.superclass=SPITFIRE.Object;SPITFIRE.Class(SPITFIRE.events.Event);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.EventDispatcher=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.events.EventDispatcher");this._eventListeners={}};SPITFIRE.events.EventDispatcher.superclass=SPITFIRE.Object;SPITFIRE.events.EventDispatcher.prototype={bind:function(b,a){if(!this._eventListeners[b]){this._eventListeners[b]=[]}this._eventListeners[b].push(a)},unbind:function(d,c){for(var b=0,a=this._eventListeners[d].length;b<a;b++){if(this._eventListeners[d][b]==c){this._eventListeners[d].splice(b,1)}}},trigger:function(d){d.target(this);var c=[d];if(this._eventListeners[d.type()]){for(var b=0,a=this._eventListeners[d.type()].length;b<a;b++){this._eventListeners[d.type()][b].apply(this,c)}}}};SPITFIRE.Class(SPITFIRE.events.EventDispatcher);SPITFIRE.display=SPITFIRE.display||{};SPITFIRE.display.DisplayObject=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.display.DisplayObject");this._scaleX=1;this._scaleY=1;this._scale=1;this._placeholderProperties=[];this._z=1};SPITFIRE.display.DisplayObject.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.display.DisplayObject.synthesizedProperties=["$this","l","t","w","h","scaleX","scaleY","scale","rect","z"];SPITFIRE.display.DisplayObject.prototype={setL:function(a){this.$this().css("left",a)},getL:function(){var a=(this.style.left)?parseFloat(this.style.left):parseFloat(this.$this().css("left"));return a||0},setT:function(a){this.$this().css("top",a)},getT:function(){var a=(this.style.top)?parseFloat(this.style.top):parseFloat(this.$this().css("top"));return a||0},getW:function(){return(this._w)?this._w*this._scaleX:this.$this().width()},setW:function(a){this._w=a;this.$this().width(this._w*this._scaleX)},getH:function(){return(this._h)?this._h*this._scaleY:this.$this().height()},setH:function(a){this._h=a;this.$this().height(this._h*this._scaleY)},getScale:function(){return(this._scaleX==this._scaleY)?this._scaleX:undefined},setScale:function(a){this._scale=a;this.scaleX(a);this.scaleY(a)},setScaleX:function(a){this._scaleX=a;this.w(this._w)},setScaleY:function(a){this._scaleY=a;this.h(this._h)},getRect:function(){return new SPITFIRE.geom.Rectangle(this.l(),this.t(),this.w(),this.h())},setRect:function(a){this.l(a.x());this.t(a.y());this.w(a.width());this.h(a.height())},setZ:function(a){this._z=a>>0;this.$this().css("z-index",this._z)},init:function(){this.$this($(this))},animate:function(c,b){for(var d in c){if(SPITFIRE.isSynthesizedProperty(d,SPITFIRE.display.DisplayObject)){var a=d+"AnimationValue";c[a]=c[d];delete c[d];this[a]=this[d]();this._placeholderProperties.push(a)}}if(b.step){this.providedAnimationStep=b.step}b.step=this.animationStep.context(this);if(b.complete){this.providedAnimationComplete=b.complete}b.complete=this.animationComplete.context(this);this.$this().animate(c,b)},animationStep:function(a,b){var c=/AnimationValue/;if(b.prop.search(c)!=-1){this[b.prop.replace(c,"")](a)}if(this.providedAnimationStep){this.providedAnimationStep(a,b)}},animationComplete:function(){if(this.providedAnimationComplete){this.providedAnimationComplete()}delete this.providedAnimationComplete;delete this.providedAnimationStep;while(this._placeholderProperties.length>0){delete this[this._placeholderProperties[0]];this._placeholderProperties.shift()}},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.display.DisplayObject);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.Task=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.Task");this.progress(0)};SPITFIRE.tasks.Task.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.tasks.Task.synthesizedProperties=["progress","progressive","name","debug"];SPITFIRE.tasks.Task.prototype={start:function(){this.progress(0)},complete:function(){this.progress(1);this.trigger(new SPITFIRE.events.Event(SPITFIRE.events.Event.COMPLETE))},toString:function(){return"["+this.qualifiedClassName()+" name="+this.name()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.Task);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.TaskManager=function(){this._progressiveTasks=[];this._createdTasks=[];this._tasks=[];this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.TaskManager")};SPITFIRE.tasks.TaskManager.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.TaskManager.synthesizedProperties=["tasks"];SPITFIRE.tasks.TaskManager.prototype={setTasks:function(c){var b,a;for(b=0,a=this._tasks.length;b<a;b+=1){this.removeTask(this.tasks()[b])}this._tasks=[];for(b=0,a=c.length;b<a;b+=1){this.addTask(c[b])}},getProgress:function(){var d=0,c,a;for(c=0,a=this._progressiveTasks.length;c<a;c+=1){var b=this._progressiveTasks[c];d+=b.progress}return d/Math.max(this._progressiveTasks.length,1)},setProgress:function(c){var b,a;for(b=0,a=this._progressiveTasks.length;b<a;b+=1){this._progressiveTasks[b].progress(c)}},setDebug:function(c){this.callSuper(c);var b,a;for(b=0,a=this.tasks().length;b<a;b+=1){this.tasks()[b].debug(c)}},addTask:function(a){if(a){this._tasks.push(a);if(a.progressive()){this._progressiveTasks.push(a)}if(this.debug()){a.debug(this.debug())}this.setProgressive()}return a},addTaskAt:function(a,b){if(a){if(a.progressive()){this._progressiveTasks.push(a);this.progressive(true)}this.tasks().splice(b,0,a);if(this.debug()){a.debug(this.debug())}this.setProgressive()}return a},contains:function(a){return this.tasks().indexOf(a)!=-1},getTaskAt:function(a){return this.tasks()[a]},getTaskByName:function(c){var e,d,a;for(d=0,a=this.tasks().length;d<a;d+=1){var b=this.tasks()[d];if(b.name()==c){e=b;break}}return e},getTaskIndex:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}return this.tasks().indexOf(a)},removeTask:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}var b=this.getTaskIndex(a);if(b!=-1){this.removeTaskAt(b)}this.setProgressive();return a},removeTaskAt:function(c){var b=this.getTaskAt(c);this.tasks().splice(c,1);var a=this._progressiveTasks.indexOf(b);if(a!=-1){this._progressiveTasks.splice(a,1)}this.setProgressive();return b},setTaskIndex:function(a,b){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}var c=this.getTaskIndex(a);this.tasks().splice(b,0,this.tasks()[c]);this.tasks().splice(c,1)},swapTasksAt:function(c,b){var a=this.tasks()[c];this.tasks()[c]=this.tasks()[b];this.tasks()[b]=a},setProgressive:function(){this._progressive=(this._progressiveTasks.length>0)},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.TaskManager);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.ModelEvent=function(c,d,b,a){this.callSuper(c,d,b,a)};SPITFIRE.events.ModelEvent.DATA_UPDATE="dataUpdate";SPITFIRE.events.ModelEvent.superclass=SPITFIRE.events.Event;SPITFIRE.Class(SPITFIRE.events.ModelEvent);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.StateEvent=function(c,d,b,a){this.callSuper(c,d,b,a)};SPITFIRE.events.StateEvent.CHILD_STATE_CHANGE="childStateChange";SPITFIRE.events.StateEvent.STATE_CHANGE="stateChange";SPITFIRE.events.StateEvent.STATE_ACTIVATED="stateActivated";SPITFIRE.events.StateEvent.superclass=SPITFIRE.events.Event;SPITFIRE.Class(SPITFIRE.events.StateEvent);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.StateManagerEvent=function(c,e,b,a,d){this.callSuper(c,e,b,a);this.state(d);this.qualifiedClassName("SPITFIRE.events.StateManagerEvent")};SPITFIRE.events.StateManagerEvent.LOAD_IN_START="loadInStart";SPITFIRE.events.StateManagerEvent.LOAD_IN_COMPLETE="loadInComplete";SPITFIRE.events.StateManagerEvent.TRANSITION_IN_START="transitionInStart";SPITFIRE.events.StateManagerEvent.TRANSITION_IN_COMPLETE="transitionInComplete";SPITFIRE.events.StateManagerEvent.LOAD_OUT_START="loadOutStart";SPITFIRE.events.StateManagerEvent.LOAD_OUT_COMPLETE="loadOutComplete";SPITFIRE.events.StateManagerEvent.TRANSITION_OUT_START="transitionOutStart";SPITFIRE.events.StateManagerEvent.TRANSITION_OUT_COMPLETE="transitionOutComplete";SPITFIRE.events.StateManagerEvent.TRANSITION_IN_STATE_COMPLETE="transitionInStateComplete";SPITFIRE.events.StateManagerEvent.TRANSITION_OUT_STATE_COMPLETE="transitionOutStateComplete";SPITFIRE.events.StateManagerEvent.LOAD_IN_STATE_COMPLETE="loadInStateComplete";SPITFIRE.events.StateManagerEvent.LOAD_OUT_STATE_COMPLETE="loadOutStateComplete";SPITFIRE.events.StateManagerEvent.DEEPLINK="deeplink";SPITFIRE.events.StateManagerEvent.superclass=SPITFIRE.events.Event;SPITFIRE.events.StateManagerEvent.synthesizedProperties=["state"];SPITFIRE.Class(SPITFIRE.events.StateManagerEvent);SPITFIRE.events=SPITFIRE.events||{};SPITFIRE.events.TimerEvent=function(c,d,b,a){this.callSuper(c,d,b,a);this.qualifiedClassName("SPITFIRE.events.TimerEvent")};SPITFIRE.events.TimerEvent.TIMER="timer";SPITFIRE.events.TimerEvent.TIMER_COMPLETE="timerComplete";SPITFIRE.events.TimerEvent.superclass=SPITFIRE.events.Event;SPITFIRE.Class(SPITFIRE.events.TimerEvent);SPITFIRE.geom=SPITFIRE.geom||{};SPITFIRE.geom.Point=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.geom.Point");this.x=a;this.y=b};SPITFIRE.geom.Point.superclass=SPITFIRE.Object;SPITFIRE.geom.Point.prototype={toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.geom.Point);SPITFIRE.geom=SPITFIRE.geom||{};SPITFIRE.geom.Rectangle=function(b,d,c,a){this.callSuper();this.qualifiedClassName("SPITFIRE.geom.Rectangle");this.x(b);this.y(d);this.width(c);this.height(a)};SPITFIRE.geom.Rectangle.superclass=SPITFIRE.Object;SPITFIRE.geom.Rectangle.synthesizedProperties=["x","y","width","height","top","left","right","bottom","size","bottomRight","topLeft"];SPITFIRE.geom.Rectangle.prototype={getTop:function(){return this.y()},getLeft:function(){return this.x()},getRight:function(){return this.x()+this.width()},getBottom:function(){return this.y()+this.height()},getSize:function(){return new SPITFIRE.geom.Point(this.width(),this.height())},getTopLeft:function(){return new SPITFIRE.geom.Point(this.top(),this.left())},getBottomRight:function(){return new SPITFIRE.geom.Point(this.bottom(),this.right())},clone:function(){return new SPITFIRE.geom.Rectangle(this.x(),this.y(),this.width(),this.height())},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.geom.Rectangle);SPITFIRE.math=SPITFIRE.math||{};SPITFIRE.math.Percent=function(a,b){this.callSuper();a=b||0;b=b||true;if(b){this.decimalPercentage(a)}else{this.percentage(a)}};SPITFIRE.math.Percent.superclass=SPITFIRE.Object;SPITFIRE.synthesizedProperties=["percentage","decimalPercentage"];SPITFIRE.prototype={getPercentage:function(){return 100*this._percent},setPercentage:function(a){this._percent=a*0.01},getDecimalPercentage:function(){return this._percent},setDecimalPercentage:function(a){this._percent=a},equals:function(a){return this.decimalPercentage()==a.decimalPercentage()},clone:function(){return new SPITFIRE.math.Percent(this.decimalPercentage())},valueOf:function(){return this.decimalPercentage()},toString:function(){return this.decimalPercentage().toString()}};SPITFIRE.Class(SPITFIRE.math.Percent);SPITFIRE.model=SPITFIRE.model||{};SPITFIRE.model.Model=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.model.Model")};SPITFIRE.model.Model.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.model.Model.synthesizedProperties=["data"];SPITFIRE.model.Model.prototype={setData:function(a){this._data=a;this.trigger(new SPITFIRE.events.ModelEvent(SPITFIRE.events.ModelEvent.DATA_UPDATE))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.model.Model);SPITFIRE.state=SPITFIRE.state||{};SPITFIRE.state.Redirect=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.state.Redirect");this.location(a);this.newLocation(b)};SPITFIRE.state.Redirect.superclass=SPITFIRE.Object;SPITFIRE.state.Redirect.synthesizedProperties=["location","newLocation"];SPITFIRE.Class(SPITFIRE.state.Redirect);SPITFIRE.state=SPITFIRE.state||{};SPITFIRE.state.State=function(a){this.callSuper();this.name(a);this._children=[];this.qualifiedClassName("SPITFIRE.state.State")};SPITFIRE.state.State.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.state.State.synthesizedProperties=["root","children","stateManager","parent","name","title","description","defaultChild","selectedChild","activatedChild","selectedChildIndex","selected","index","stateLocation","selectable","pageViewName","numChildren","transitionIn","transitionOut","loadIn","loadOut","activated","childClass"];SPITFIRE.state.State.prototype={setRoot:function(c){this._root=c;for(var b=0,a=this.children().length;b<a;b+=1){this.children()[b].root(this.root())}},setStateManager:function(c){this._stateManager=c;for(var b=0,a=this.children().length;b<a;b+=1){this.children()[b].stateManager(this.stateManager())}},setChildren:function(c){for(var b=0,a=this.children().length;b<a;b+=1){this.removeChild(this.children()[b])}this.children()=[];for(b=0,a=c.length;b<a;b++){this.addChild(c[b])}},setSelectedChild:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}this._selectedChild=a},getActivatedChild:function(){var c,b,a;for(b=0,a=this.children().length;b<a;b+=1){child=this.children()[b];if(child.activated){c=child;break}}return c},getNumChildren:function(){return this.children().length},getSelectedChildIndex:function(){var a;if(this.selectedChild()){a=this.getChildIndex(this.selectedChild())}return a},setSelectedChildIndex:function(a){var b=this.getChildAt(a);this.selectedChild(b)},setSelected:function(a){if(a!=this.selected()){this._selected=a;this.trigger(new SPITFIRE.events.StateEvent(SPITFIRE.events.StateEvent.STATE_CHANGE))}},getIndex:function(){return this.parent().getChildIndex(this)},getStateLocation:function(){var d=[],f=this,c="",e,a,b;while(f){d.push(f);f=f.parent()}d.reverse();for(e=0,a=d.length;e<a;e+=1){b=d[e];c+=b.name();if(b!=d[a-1]){c+="/"}}return c},childChangeHandler:function(a){var b=a.target();if(b.selected()){this._selectedChild=b}else{if(b==this._selectedChild){this._selectedChild=undefined}}this.trigger(new SPITFIRE.events.StateEvent(SPITFIRE.events.StateEvent.CHILD_STATE_CHANGE))},addChild:function(a){a.parent(this);a.stateManager(this.stateManager());a.root(this.root());this.children().push(a);a.bind(SPITFIRE.events.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this))},addChildAt:function(b,a){b.parent(this);b.stateManager(this.stateManager());b.root(this.root());this.children().splice(a,0,b);b.bind(SPITFIRE.events.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this));return b},contains:function(a){return this.children().indexOf(a)!=-1},getChildAt:function(a){return this.children()[a]},getChildByName:function(b){var d,c,a,e;for(c=0,a=this.children().length;c<a;c+=1){e=this.children()[c];if(e.name()==b){d=e;break}}return d},getChildIndex:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}return this.children().indexOf(a)},removeChild:function(b){if(!this.contains(b)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}var a=this.getChildIndex(b),b;if(a!=-1){b=this.removeChildAt(a)}return b},removeChildAt:function(a){var b=this.getChildAt(a);b.unbind(SPITFIRE.events.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this));this.children().splice(a,1);return b},setChildIndex:function(c,a){if(!this.contains(c)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}var b=this.getChildIndex(c);this.children().splice(a,0,this.children()[b]);this.children().splice(b,1)},swapChildrenAt:function(c,b){var a=this.children()[c];this.children()[c]=this.children()[b];this.children()[b]=a},setSelectedChildByName:function(b){var d,c,a,e;for(c=0,a=this.children().length;c<a;c+=1){e=this.children()[c];if(e.name()==b){d=e;break}}if(d){this.selectedChild(d)}else{throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}},browse:function(){this.stateManager().location(this.stateLocation())},browsePreviousSibling:function(){var a=this.index-1;if(a<0){a=this.parent().children().length-1}this.parent().getChildAt(a).browse()},browseNextSibling:function(){var a=index+1;if(a>this.parent().children().length-1){a=0}this.parent().getChildAt(a).browse()},browsePreviousChild:function(){var a=this.selectedChildIndex()-1;if(a<0){a=this.children().length-1}this.getChildAt(a).browse()},browseNextChild:function(){var a=this.selectedChildIndex()+1;if(a>this.children().length-1){a=0}this.getChildAt(a).browse()},getChildFromPath:function(e){var c=this,b,a;if(e.length>0){var d=e.split("/");for(b=0,a=d.length;b<a;b+=1){c=c.getChildByName(d[b])}}return c},createChildByName:function(b){if(!this.childClass()){throw new SPITFIRE.Error(this+": no child class defined")}var a=new this.childClass();a.name(b);this.addChild(a);return a},toString:function(){return"[State name="+this.name()+" title="+this.title()+" className="+this.qualifiedClassName()+" defaultChild="+this.defaultChild()+"]"}};SPITFIRE.Class(SPITFIRE.state.State);SPITFIRE.state=SPITFIRE.state||{};SPITFIRE.state.StateManager=function(b,a){this.callSuper();this.root(a);this.qualifiedClassName("SPITFIRE.state.StateManager");this.name(b||this.qualifiedClassName()+Math.round(Math.random()*100000));this.pageViewType(SPITFIRE.state.StateManager.PAGE_VIEW_LOCATION);this._progressTimer=new SPITFIRE.utils.Timer(33);this._progressTimer.bind(SPITFIRE.events.TimerEvent.TIMER,this.taskManagerProgressHandler.context(this));this._transitionInPath;this._transitionWasInterrupted;this._isInTransition;this._transitions;this._currentTransition;this._redirects=[]};SPITFIRE.state.StateManager.PAGE_VIEW_LOCATION="pageViewLocation";SPITFIRE.state.StateManager.PAGE_VIEW_NAME="pageViewName";SPITFIRE.state.StateManager.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.state.StateManager.synthesizedProperties=["root","deepLinking","tree","startLocation","location","activeStates","taskManager","preloader","selectedStates","debug","trackViewPages","pageViewType","redirects","name"];SPITFIRE.state.StateManager.prototype={setDeepLinking:function(a){this._deepLinking=a;if(this.deepLinking()){this.deepLinking().change(this.deepLinkingChangeHandler.context(this))}},setTree:function(a){this._tree=a;a.stateManager(this);a.root(this.root())},getLocation:function(){var c=this.selectedStates(),e="",d,a;for(d=0,a=c.length;d<a;d+=1){var b=c[d];e+=b.name();if(b!=c[c.length-1]){e+="/"}}return e},setLocation:function(c){if(this.deepLinking()){var e=c.split("/");e.shift();var d="/"+e.join("/");this.deepLinking().value(d)}else{var a=c.split("/");a.shift();var b=this.tree();if(a.length>0){b=b.getChildFromPath(a.join("/"))}this._transitionInPath=b.stateLocation();this.checkIfInTransition()}},getSelectedStates:function(){var a=[],b;if(this.tree().selected()){b=this.tree()}while(b){a.push(b);b=b.selectedChild()}return a},deepLinkingChangeHandler:function(a){var b=this.deepLinking().value();if(b==""||b=="/"){this._transitionInPath=this.tree().stateLocation()}else{this._transitionInPath=this.tree().name()+b}this.checkIfInTransition()},taskManagerProgressHandler:function(b){var a=this.taskManager().progress();if(this.debug()){log(this.name()+" totalProgress = "+a)}if(isNaN(a)){a=0}if(this.preloader()){this.preloader().progress(a)}},transitionInCompleteHandler:function(a){if(this.trackPageViews()){var b;switch(this.pageViewType()){case SPITFIRE.state.StateManager.PAGE_VIEW_LOCATION:b=this.location();break;case SPITFIRE.state.StateManager.PAGE_VIEW_NAME:b=this.location();break}}},taskManagerCompleteHandler:function(a){this.taskManager().unbind(SPITFIRE.events.Event.COMPLETE,this.taskManagerCompleteHandler.context(this));if(this.taskManager().progressive()){this.taskManagerProgressHandler();this._progressTimer.stop()}this.trigger(new SPITFIRE.events.Event(this._currentTransition.transitionName()+"Complete"));this._currentTransition=null;if(this._transitions.length>0){this.startTransition()}else{this._transitions=null;this._isInTransition=false;if(this._transitionWasInterrupted){this.startTransitions()}}},init:function(){if(this.deepLinking()){if(this.deepLinking().value()!="/"){this.deepLinkingChangeHandler()}else{if(this.startLocation()){this.location(this.startLocation())}else{this._transitionInPath=this.tree().stateLocation();this.checkIfInTransition()}}}else{if(this.startLocation()){this.location(this.startLocation())}else{this._transitionInPath=this.tree().stateLocation();this.checkIfInTransition()}}},checkIfInTransition:function(){if(this._isInTransition){this._transitionWasInterrupted=true}else{this.startTransitions()}},startTransitions:function(){this._transitionWasInterrupted=false;this._isInTransition=false;this._transitionInPath=this.checkRedirect(this._transitionInPath);var c=this._transitionInPath.split("/");var k=[];if(this.location().length>0){k=this.location().split("/")}var d=0,e,g,h,l,f,b;for(e=0,g=k.length;e<g;e+=1){h=k.slice(0,e+1);l=h.join("/");f=c.slice(0,e+1);b=f.join("/");if(l==b){d+=1}}this._transitions=[];var a=[];for(e=k.length-1;e>=d;e-=1){h=k.slice(0,e+1);a.push(h.join("/"))}this.deactivateStates(a);this._transitions.push(new SPITFIRE.state.TransitionProperties(a.slice(),"loadOut",false));this._transitions.push(new SPITFIRE.state.TransitionProperties(a.slice(),"transitionOut",false));var j=[];for(e=d,g=c.length;e<g;e+=1){f=c.slice(0,e+1);j.push(f.join("/"))}j=this.activateStates(j);if(j.length==0){j=this.checkForDefaultStates(this._transitionInPath)}this._transitions.push(new SPITFIRE.state.TransitionProperties(j.slice(),"loadIn",false));this._transitions.push(new SPITFIRE.state.TransitionProperties(j.slice(),"transitionIn",false));this.startTransition()},deactivateStates:function(c){var g,h;for(g=0,h=c.length;g<h;g+=1){var k=c[g];var d=k.split("/");d.shift();var a=this.tree();if(d.length>0){var f,e;for(f=0,e=d.length;f<e;f+=1){var b=a;a=b.getChildByName(d[f])}}a.activated(false)}},activateStates:function(c){var e=[],h,k;this._activeStates=[];for(h=0,k=c.length;h<k;h+=1){var m=c[h];var d=m.split("/");d.shift();var a=this.tree();if(d.length>0){var g,f;for(g=0,f=d.length;g<f;g+=1){var b=a;a=b.getChildByName(d[g]);if(!a){a=b.createChildByName(d[g])}}}a.activated(true);this.activeStates().push(a);e.push(a.stateLocation());if(a.stateLocation()==c[c.length-1]){var l=a.getChildByName(a.defaultChild());while(l){l.activated(true);this.activeStates().push(l);e.push(l.stateLocation());l=l.getChildByName(l.defaultChild())}}}return e},checkForDefaultStates:function(g){var h=[];var f=g.split("/");f.shift();var e=this.tree();if(f.length>0){var c,a;for(c=0,a=f.length;c<a;c+=1){var d=e;e=d.getChildByName(f[c])}}var b=e.getChildByName(e.defaultChild);while(b){b.activated(true);this.activeStates().push(b);h.push(b.stateLocation());b=b.getChildByName(b.defaultChild())}return h},startTransition:function(){this._currentTransition=this._transitions.shift();this.trigger(new SPITFIRE.events.Event(this._currentTransition.transitionName()+"Start"));this.taskManager(new SPITFIRE.tasks.SequentialTask());this.taskManager().name(this._currentTransition.transitionName());if(this.debug()){this.taskManager().debug(this.debug())}this.taskManager().bind(SPITFIRE.events.Event.COMPLETE,this.taskManagerCompleteHandler.context(this));var d,a;for(d=0,a=this._currentTransition.locations().length;d<a;d+=1){var g=this._currentTransition.locations()[d];var f=g.split("/");f.shift();var e=this.tree();if(f.length>0){e=e.getChildFromPath(f.join("/"))}var c=e[this._currentTransition.transitionName()]();if(c){this.taskManager().addTask(c)}var b;if(this._currentTransition.transitionName()=="transitionIn"){b=true}if(this._currentTransition.transitionName()=="transitionOut"){b=false}this.taskManager().addTask(new SPITFIRE.tasks.PropertyTask(e,"selected",b))}if(this.taskManager().progress()==1){this.taskManager().progressive(false)}if(this.taskManager().progressive()){if(this.preloader()){this.taskManager().addTaskAt(new SPITFIRE.tasks.PropertyTask(this.preloader(),"progress",0),0);this.taskManager().addTaskAt(this.preloader().transitionIn(),1);this.taskManager().addTask(this.preloader().transitionOut())}this.taskManager().progress(0);this._progressTimer.start()}this.taskManager().start()},addRedirect:function(a,b){this.removeRedirect(a);this.redirects.push(new SPITFIRE.state.Redirect(a,b))},removeRedirect:function(b){var d=[];var c,a;for(c=0,a=this.redirects().length;c<a;c+=1){var e=this.redirects()[c];if(e.location()!=b){d.push(e)}}this.redirects(d)},checkRedirect:function(c){var b,a;for(b=0,a=this.redirects().length;b<a;b+=1){var d=redirects()[b];if(c==d.location()){c=d.newLocation()}}return c},toString:function(){return"[StateManager name="+this.name()+" className = "+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.state.StateManager);SPITFIRE.state=SPITFIRE.state||{};SPITFIRE.state.TransitionProperties=function(a,b,c){this.callSuper();this.locations(a);this.transitionName(b);this.showPreloader(c)};SPITFIRE.state.TransitionProperties.superclass=SPITFIRE.Object;SPITFIRE.state.TransitionProperties.synthesizedProperties=["locations","transitionName","showPreloader","currentState"];SPITFIRE.state.TransitionProperties.prototype={toString:function(){return this.transitionName()}};SPITFIRE.Class(SPITFIRE.state.TransitionProperties);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.FunctionTask=function(c,d){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.FunctionTask");this.method(d);this.context(c);this.args([]);var b,a;for(b=2,a=arguments.length;b<a;b+=1){this.args().push(arguments[b])}};SPITFIRE.tasks.FunctionTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.FunctionTask.synthesizedProperties=["context","method","args"];SPITFIRE.tasks.FunctionTask.prototype={start:function(){this.method().apply(this.context(),this.args());this.complete()},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.FunctionTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.JQueryAjaxTask=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.JQueryAjaxTask");this.url(a);this.settings(b)};SPITFIRE.tasks.JQueryAjaxTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.JQueryAjaxTask.synthesizedProperties=["url","settings","content"];SPITFIRE.tasks.JQueryAjaxTask.prototype={ajaxSuccessHandler:function(b,c,a){this.content(b);this.complete()},ajaxErrorHandler:function(a,c,b){if(this.debug()){log(this+" Error: could not load this file. textStatus="+c+" errorThrown="+b)}this.complete()},ajaxComplete:function(a,b){if(this.debug()){log(this+" Complete: textStatus="+b)}},start:function(){$.ajax(this.url(),this.settings()).success(this.ajaxSuccessHandler.context(this)).error(this.ajaxErrorHandler.context(this)).complete(this.ajaxComplete.context(this))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.JQueryAjaxTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.JQueryEffectTask=function(c,b){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.JQueryEffectTask");var a=SPITFIRE.slice(arguments,2,arguments.length-1);if(!SPITFIRE.isFunction(c[b])){throw new SPITFIRE.Error("target does not support this effect")}this.target(c);this.effect(b);this.args(a)};SPITFIRE.tasks.JQueryEffectTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.JQueryEffectTask.synthesizedProperties=["target","effect","args"];SPITFIRE.tasks.JQueryEffectTask.prototype={effectCompleteHandler:function(){this.complete()},start:function(){this.args().push($.proxy(this.effectCompleteHandler,this));this.target()[this.effect()].apply(this.target(),this.args())},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.JQueryEffectTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.JQueryGetJSONTask=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.JQueryGetJSONTask");this.url(a);this.data(b)};SPITFIRE.tasks.JQueryGetJSONTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.JQueryGetJSONTask.synthesizedProperties=["url","data","content"];SPITFIRE.tasks.JQueryGetJSONTask.prototype={jsonHandler:function(a,b){switch(b){case"success":this.content(a);break}this.complete()},start:function(){$.getJSON(this.url(),this.jsonHandler.context(this))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.JQueryGetJSONTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.JQueryImageLoaderTask=function(a){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.JQueryImageLoaderTask");this.url(a);this.content(new Image());this.$content($(this.content()));this.$content().load(this.completeHandler.context(this)).error(this.errorHandler.context(this))};SPITFIRE.tasks.JQueryImageLoaderTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.JQueryImageLoaderTask.synthesizedProperties=["url","content","$content"];SPITFIRE.tasks.JQueryImageLoaderTask.prototype={completeHandler:function(){this.complete()},errorHandler:function(){if(this.debug()){log(this+" Error: could not load this file.")}this.complete()},start:function(){this.$content().attr("src",this.url())},toString:function(){return"["+this.qualifiedClassName()+" url="+this.url()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.JQueryImageLoaderTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.JQueryLoadTask=function(b,a){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.JQueryLoadTask");if(!b){throw new SPITFIRE.Error("a valid url must be specified")}this.url(b);this.$target(a||$("body"))};SPITFIRE.tasks.JQueryLoadTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.JQueryLoadTask.synthesizedProperties=["url","$target"];SPITFIRE.tasks.JQueryLoadTask.prototype={loadHandler:function(b,a,c){if(a=="error"){log(this+" Error: could not load this file")}this.complete()},start:function(){this.$target().load(this.url(),this.loadHandler.context(this))},toString:function(){return"["+this.qualifiedClassName()+" url="+this.url()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.JQueryLoadTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.ParallelTask=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.ParallelTask");if(arguments.length>0){this.tasks(arguments)}};SPITFIRE.tasks.ParallelTask.superclass=SPITFIRE.tasks.TaskManager;SPITFIRE.tasks.ParallelTask.prototype={taskCompleteHandler:function(b){var a=b.target();if(this.debug()){log("taskComplete "+a)}a.unbind(SPITFIRE.events.Event.COMPLETE,this.taskCompleteHandler.context(this));this._createdTasks.push(a);if(this._createdTasks.length==this.tasks().length){if(this.debug()){log("tasksComplete "+this)}this.complete()}},start:function(){this._createdTasks=[];if(this.tasks().length>0){var c,a;for(c=0,a=this.tasks().length;c<a;c+=1){var b=this.tasks()[c];b.bind(SPITFIRE.events.Event.COMPLETE,this.taskCompleteHandler.context(this));if(this.debug()){log("taskStart "+b)}b.start()}}else{this.complete()}},toString:function(){return"["+this.qualifiedClassName()+" name="+this.name()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.ParallelTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.PropertyTask=function(c,b,a){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.PropertyTask");this.target(c);this.property(b);this.value(a)};SPITFIRE.tasks.PropertyTask.superclass=SPITFIRE.tasks.Task;SPITFIRE.tasks.PropertyTask.synthesizedProperties=["target","property","value"];SPITFIRE.tasks.PropertyTask.prototype={start:function(){this.target()[this.property()](this.value());this.complete()},toString:function(){return"["+this.qualifiedClassName()+" target="+this.target()+" property="+this.property()+" value="+this.value()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.PropertyTask);SPITFIRE.tasks=SPITFIRE.tasks||{};SPITFIRE.tasks.SequentialTask=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.tasks.SequentialTask");if(arguments.length>0){this.tasks(arguments)}};SPITFIRE.tasks.SequentialTask.superclass=SPITFIRE.tasks.TaskManager;SPITFIRE.tasks.SequentialTask.synthesizedProperties=[];SPITFIRE.tasks.SequentialTask.prototype={taskCompleteHandler:function(b){var a=b.target();if(this.debug()){log("taskComplete "+a)}a.unbind(SPITFIRE.events.Event.COMPLETE,this.taskCompleteHandler.context(this));this._createdTasks.push(a);if(this._createdTasks.length==this.tasks().length){this.complete()}else{this.createTask()}},start:function(){this._createdTasks=[];if(this.tasks().length>0){this.createTask()}else{this.complete()}},createTask:function(){var b=this._createdTasks.length;var a=this.tasks()[b];a.bind(SPITFIRE.events.Event.COMPLETE,this.taskCompleteHandler.context(this));if(this.debug()){log("taskStart "+a)}a.start()},toString:function(){return"["+this.qualifiedClassName()+" name="+this.name()+"]"}};SPITFIRE.Class(SPITFIRE.tasks.SequentialTask);SPITFIRE.ui=SPITFIRE.ui||{};SPITFIRE.ui.UIButton=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.ui.UIButton")};SPITFIRE.ui.UIButton.superclass=SPITFIRE.display.DisplayObject;SPITFIRE.ui.UIButton.synthesizedProperties=[];SPITFIRE.ui.UIButton.prototype={mouseOverHandler:function(a){this.$this().addClass("sf-over")},mouseOutHandler:function(a){this.$this().removeClass("sf-over")},clickHandler:function(a){},mouseUpHandler:function(a){this.$this().removeClass("sf-down")},mouseDownHandler:function(a){this.$this().addClass("sf-down")},init:function(){this.callSuper();SPITFIRE.addListener(this,"click","clickHandler");SPITFIRE.addListener(this,"mouseover","mouseOverHandler");SPITFIRE.addListener(this,"mouseout","mouseOutHandler");SPITFIRE.addListener(this,"mouseup","mouseUpHandler");SPITFIRE.addListener(this,"mousedown","mouseDownHandler")},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.ui.UIButton);SPITFIRE.ui=SPITFIRE.ui||{};SPITFIRE.ui.UICarousel=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.ui.UICarousel");this._items=[];this._itemHeight=200;this._neighbors=2;this._itemDistance=160;this._speed=500;this._scaleRatio=0.3;this._positionIndex=0};SPITFIRE.ui.UICarousel.superclass=SPITFIRE.display.DisplayObject;SPITFIRE.ui.UICarousel.synthesizedProperties=["items","center","itemHeight","neighbors","itemDistance","positionIndex","startX","centerIndex","speed","scaleRatio"];SPITFIRE.ui.UICarousel.prototype={setPositionIndex:function(j){var e=this._positionIndex;var k=this.items()[e].carouselIndex()-this.items()[j].carouselIndex();var b,f,n,l,h,c,d,a,g,m=(this.items().length*0.5>>0)+1;for(b=0,f=this.items().length;b<f;b+=1){n=this.items()[b];l=n.carouselIndex()+k;l=(l<0||l>=f)?(l<0)?l+f:l-f:l;n.carouselIndex(l);n.carousel(this);h=n.carouselIndex()*this.itemDistance()+this.startX();c=Math.abs(this.centerIndex()-l);g=(m-c)*25;d=(c<=this.neighbors())?1:0;a=1-c*this.scaleRatio();n.animate({l:h,t:this.center().y,opacity:d,scale:a,z:g},{duration:this._speed*Math.abs(k)})}this._positionIndex=j;this.trigger(new SPITFIRE.events.Event(SPITFIRE.events.Event.CHANGE))},init:function(){this.callSuper();this.center(new SPITFIRE.geom.Point(Math.round(this.w()*0.5),Math.round(this.h()*0.5)));this.$this().addClass("sf-carousel");var b=this.getElementsByTagName("div");var c,a,d;for(c=0,a=b.length;c<a;c+=1){d=b[c];d.index(c);d.itemHeight(this.itemHeight());this.items().push(d)}this.positionItems();this.positionIndex(0)},positionItems:function(){var c=this._positionIndex+1,l=(this._positionIndex-1>=0)?this._positionIndex-1:this.items().length-1,d=l,b=c,g=this.center().x,e=this.center().y,n=this.items()[this._positionIndex],a=g+this.itemDistance(),f=g-this.itemDistance(),i,m,k=0,h=Math.ceil((this.items().length-1)*0.5),j;this.centerIndex(Math.floor(this.items().length*0.5));n.l(g);n.t(e);n.$this().css("opacity",1);n.carouselIndex(this.centerIndex());while(k<h){k++;j=(k>this.neighbors())?0:1;i=this.items()[c];if(i){i.l(a);i.t(e);i.carouselIndex(this.centerIndex()+k);i.$this().css("opacity",j);a+=this.itemDistance();c++;if(c>=this.items().length){c=0}}m=this.items()[l];if(m){m.l(f);m.t(e);m.carouselIndex(this.centerIndex()-k);m.$this().css("opacity",j);f-=this.itemDistance();l--;if(l<0){l=this.items().length-1}}}this.startX(m.l())},previous:function(){var a=this.positionIndex()-1;a=(a<0)?this.items().length-1:a;this.positionIndex(a)},next:function(){var a=this.positionIndex()+1;a=(a>=this.items().length)?0:a;this.positionIndex(a)},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.ui.UICarousel);SPITFIRE.ui=SPITFIRE.ui||{};SPITFIRE.ui.UICarouselItem=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.ui.UICarouselItem");this._itemHeight=100;this._isImgInitialized=false};SPITFIRE.ui.UICarouselItem.superclass=SPITFIRE.display.DisplayObject;SPITFIRE.ui.UICarouselItem.synthesizedProperties=["index","carouselIndex","carousel","img","itemHeight","itemWidth","isImgInitialized"];SPITFIRE.ui.UICarouselItem.prototype={setItemHeight:function(a){this._itemHeight=a;if(this.img().complete){this.imageLoadedHandler()}},setScale:function(a){this._scale=a;if(this.img().complete){this.imageLoadedHandler()}},getScale:function(){return this._scale},imageLoadedHandler:function(){SPITFIRE.removeListener(this.img(),"load",this.imageLoadedHandler);this.initImage();this.resizeImage();this.scaleAndPositionImage()},init:function(){this.callSuper();this.img(this.getElementsByTagName("img")[0]);if(!this.img().complete){SPITFIRE.addListener(this.img(),"load",this.imageLoadedHandler,this)}else{this.imageLoadedHandler()}},initImage:function(){if(this._isImgInitialized){return}this.img().w(this.img().width);this.img().h(this.img().height);this._isImgInitialized=true},resizeImage:function(){var b=new SPITFIRE.geom.Rectangle(0,0,this.img().w(),this.img().h());var a=SPITFIRE.utils.RatioUtils.scaleWidth(b,this._itemHeight,true);this.img().w(a.width());this.img().h(a.height())},scaleAndPositionImage:function(){this.img().scale(this._scale);this.img().l(Math.round(-this.img().w()*0.5));this.img().t(Math.round(-this.img().h()*0.5))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.ui.UICarouselItem);SPITFIRE.utils=SPITFIRE.utils||{};SPITFIRE.utils.ArrayUtils=SPITFIRE.utils.ArrayUtils||{};SPITFIRE.utils.ArrayUtils.getItemByKeys=function(f,b){var d=-1,e,a;while(++d<f.length){e=f[d];a=true;for(var c in b){if(!e.hasOwnProperty(c)||e[c]!=b[c]){a=false}}if(a){return e}}return undefined};SPITFIRE.utils.ArrayUtils.getItemsByKeys=function(g,b){var e=[],d=-1,f,a;while(++d<g.length){f=g[d];a=true;for(var c in b){if(!f.hasOwnProperty(c)||f[c]!=b[c]){a=false}}if(a){e.push(f)}}return e};SPITFIRE.utils.ArrayUtils.getItemByAnyKey=function(e,a){var c=-1,d;while(++c<e.length){d=e[c];for(var b in a){if(!d.hasOwnProperty(b)||d[b]!=a[b]){return d}}}return undefined};SPITFIRE.utils.ArrayUtils.getItemsByAnyKey=function(g,b){var e=[],d=-1,f,a;while(++d<g.length){f=g[d];a=true;for(var c in b){if(!f.hasOwnProperty(c)||f[c]!=b[c]){e.push(f);break}}}return e};SPITFIRE.utils.ArrayUtils.getItemByKey=function(f,d,b){var c,a,e;for(var c=0,a=f.length;c<a;c+=1){e=f[c];if(e.hasOwnProperty(d)){if(e[d]==b){return e}}}return undefined};SPITFIRE.utils.ArrayUtils.getItemsByKey=function(g,e,b){var d,a,f,c=[];for(var d=0,a=g.length;d<a;d+=1){f=g[d];if(f.hasOwnProperty(e)){if(f[e]==b){c.push(f)}}}return c};SPITFIRE.utils=SPITFIRE.utils||{};SPITFIRE.utils.RatioUtils=SPITFIRE.utils.RatioUtils||{widthToHeight:function(a){return a.width()/a.height()},heightToWidth:function(a){return a.height()/a.width()},scale:function(b,a,c){c=c||true;return SPITFIRE.utils.RatioUtils._defineRect(b,b.width()*a.decimalPercentage(),b.height()*a.decimalPercentage(),c)},scaleWidth:function(b,a,c){c=c||true;return SPITFIRE.utils.RatioUtils._defineRect(b,a*SPITFIRE.utils.RatioUtils.widthToHeight(b),a,c)},scaleHeight:function(a,b,c){c=c||true;return SPITFIRE.utils.RatioUtils._defineRect(a,b,b*SPITFIRE.utils.RatioUtils.heightToWidth(a),c)},scaleToFill:function(b,c,d){d=d||true;var a=SPITFIRE.utils.RatioUtils.scaleHeight(b,c.width(),d);if(a.height()<c.height()){a=SPITFIRE.utils.RatioUtils.scaleWidth(b,c.height(),d)}return a},scaleToFit:function(b,c,d){d=d||true;var a=SPITFIRE.utils.RatioUtils.scaleHeight(b,c.width(),d);if(a.height()>c.height()){a=SPITFIRE.utils.RatioUtils.scaleWidth(b,c.height(),d)}return a},_defineRect:function(c,d,a,e){var b=c.clone();b.width(e?Math.round(d):d);b.height(e?Math.round(a):a);return b}};SPITFIRE.utils=SPITFIRE.utils||{};SPITFIRE.utils.Timer=function(b,a){this.callSuper();this.delay(b);this.repeatCount(a||0);this.qualifiedClassName("SPITFIRE.utils.Timer");this._interval;this._currentCount=0};SPITFIRE.utils.Timer.superclass=SPITFIRE.events.EventDispatcher;SPITFIRE.utils.Timer.synthesizedProperties=["currentCount","delay","repeatCount","running"];SPITFIRE.utils.Timer.prototype={setRunning:function(a){throw new SPITFIRE.Error("running is read-only")},setCurrentCount:function(a){throw new SPITFIRE.Error("currentCount is read-only")},reset:function(){this.stop();this._currentCount=0},start:function(){if(this._interval){return}if(this.repeatCount()&&this.currentCount()>=this.repeatCount()){return}this._interval=setTimeout(this.tick.context(this),this.delay())},stop:function(){if(this._interval){log("clear: "+this._interval);clearTimeout(this._interval)}this._interval=undefined},tick:function(){this._currentCount+=1;if(this.repeatCount()&&this._currentCount>=this.repeatCount()){this.trigger(new SPITFIRE.utils.TimerEvent(SPITFIRE.events.TimerEvent.TIMER_COMPLETE));this.reset();return}this._interval=setTimeout(this.tick.context(this),this.delay());this.trigger(new SPITFIRE.utils.TimerEvent(SPITFIRE.events.TimerEvent.TIMER))}};SPITFIRE.Class(SPITFIRE.utils.Timer);