var SPITFIRE=SPITFIRE||{};var $s=$s||SPITFIRE;SPITFIRE.browser={Opera:window.opera?true:false,IE:document.all&&!this.Opera?true:false,IE6:this.IE&&typeof(window.XMLHttpRequest)==="undefined"?true:false,IE8:this.IE&&typeof(document.querySelectorAll)!=="undefined"?true:false,IE7:this.IE&&!this.IE6&&!this.IE8?true:false,WebKit:/WebKit/i.test(navigator.userAgent)?true:false,iPhone:/iPhone|iPod/i.test(navigator.userAgent)?true:false,Chrome:/Chrome/i.test(navigator.userAgent)?true:false,Safari:/Safari/i.test(navigator.userAgent)&&!this.Chrome?true:false,Konqueror:navigator.vendor==="KDE"?true:false,Konqueror4:this.Konqueror&&/native code/.test(document.getElementsByClassName)?true:false,Gecko:!this.WebKit&&navigator.product==="Gecko"?true:false,Gecko19:this.Gecko&&Array.reduce?true:false};SPITFIRE.isArray=function(a){return typeof a==="object"&&a.length};SPITFIRE.isFunction=function(a){return typeof a==="function"};SPITFIRE.isWindow=function(a){return a&&typeof a==="object"&&"setInterval" in a};SPITFIRE.isPlainObject=function(c){if(!c||typeof c!=="object"||c.nodeType||SPITFIRE.isWindow(c)){return false}var a=Object.prototype.hasOwnProperty;if(c.constructor&&!a.call(c,"constructor")&&!a.call(c.constructor.prototype,"isPrototypeOf")){return false}var b;for(b in c){}return b===undefined||a.call(c,b)};SPITFIRE.isSynthesizedProperty=function(f,c){var b=c.synthesizedProperties,e=false;if(b){var d,a;for(d=0,a=b.length;d<a;d+=1){if(b[d]===f){e=true;break}}}return e};SPITFIRE.objectHasMethod=function(a,b){return a!==null&&a[b]!==undefined&&SPITFIRE.isFunction(a[b])};SPITFIRE.slice=function(e,d,c){var a=[],b;for(b=d;b<=c;b+=1){a.push(e[b])}return a};SPITFIRE.extend=function(){var m,c,a,b,h,k,g=arguments[0]||{},f=1,d=arguments.length,l=false,j,e;if(typeof g==="boolean"){l=g;g=arguments[1]||{};f=2}if(typeof g!=="object"&&!SPITFIRE.isFunction(g)){g={}}if(d===f){g=this;--f}for(;f<d;f++){if((m=arguments[f])!=null){for(c in m){a=g[c];b=m[c];if(g===b){continue}if(l&&b&&(SPITFIRE.isPlainObject(b)||(h=SPITFIRE.isArray(b)))){if(h){h=false;k=a&&SPITFIRE.isArray(a)?a:[]}else{k=a&&SPITFIRE.isPlainObject(a)?a:{}}g[c]=SPITFIRE.extend(l,k,b)}else{if(b!==undefined){g[c]=b}}}}}return g};SPITFIRE.addListener=function(d,c,b,a){a=a||d;if(SPITFIRE.browser.IE){d.attachEvent("on"+c,b.context(a))}else{d.addEventListener(c,b.context(a),false)}};SPITFIRE.removeListener=function(d,c,b,a){a=a||d;if(SPITFIRE.browser.IE){d.detachEvent("on"+c,b.context(a))}else{d.removeEventListener(c,b.context(a),false)}};SPITFIRE.merge=function(d,c){if(typeof d==="undefined"){return SPITFIRE.clone(c)}if(typeof c==="undefined"){return SPITFIRE.clone(d)}var a;a=SPITFIRE.clone(d);for(var b in c){if(typeof a[b]!=="undefined"){a[b]=SPITFIRE.merge(a[b],c[b])}else{a[b]=SPITFIRE.clone(c[b])}}return a};SPITFIRE.clone=function(c){if(typeof c!=="object"){return c}var a={};for(var b in c){a[b]=SPITFIRE.clone(c[b]);a[b]._name=b}return a};SPITFIRE.extendDOM=function(a){var b=$(a);SPITFIRE.extendChildren(b)};SPITFIRE.extendChildren=function(e){var n=e.filter("[sf-base]");var b=e.children();var h,l;for(h=0,l=b.length;h<l;h+=1){SPITFIRE.extendChildren($(b[h]))}if(n.length){var a=n[0];var m=a.getAttribute("sf-base");var f=m.split(".");var d,g,c;g=window;for(d=0,c=f.length;d<c;d+=1){g=g[f[d]]}if(!g){throw new SPITFIRE.Error("base class not found")}var k=new g();SPITFIRE.extend(a,k);a.init()}};if(!Array.indexOf){Array.prototype.indexOf=function(c){for(var b=0,a=this.length;b<a;b+=1){if(this[b]==c){return b}}return -1}}if(typeof Object.create!=="function"){Object.create=function(b){function a(){}a.prototype=b;return new a()}}Function.prototype.context=function(a){var b=this;temp=function(){return b.apply(a,arguments)};return temp};window.log=function(){log.history=log.history||[];log.history.push(arguments);arguments.callee=arguments.callee.caller;if(this.console){console.log(Array.prototype.slice.call(arguments))}};(function(e){function h(){}for(var g="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),f;f=g.pop();){e[f]=e[f]||h}})(window.console=window.console||{});SPITFIRE.Class=function(l){if(l.isExtended){return}if(typeof l.synthesizedProperties!=="undefined"){var j=function(i){return function(){return this["_"+i]}};var a=function(i){return function(m){this["_"+i]=m;return this}};var f=function(i){return function(){if(arguments.length>0){return this["set"+i].apply(this,arguments)}else{return this["get"+i]()}}};var d,g;for(d=0,g=l.synthesizedProperties.length;d<g;d+=1){var e=l.synthesizedProperties[d];var b=e.charAt(0).toUpperCase()+e.slice(1);if(!("get"+b in l.prototype)){l.prototype["get"+b]=j(e)}if(!("set"+b in l.prototype)){l.prototype["set"+b]=a(e)}l.prototype[e]=f(b)}}var c={};(function(i){var m=l.superclass;if(m){if(m.superclass&&!m.isExtended){arguments.callee(m.superclass)}c=h(m,c)}})(l);l=h(c,l);l.prototype.callSuper=function(){var m=arguments.callee.caller,i=m._super;if(typeof m.superclass!=="undefined"){m.superclass.apply(this,arguments)}else{if(typeof i!=="undefined"){return i.apply(this,arguments)}}};l.isExtended=true;function h(i,m){m.prototype=k(m.prototype,i.prototype);return m}function k(o,i){var m,p=/callSuper/ig;if(typeof o!=="undefined"){m=SPITFIRE.clone(o);for(var n in i){if(typeof m[n]!=="undefined"){if(m[n].toString().search(p)!==-1){m[n]._super=i[n]}}else{m[n]=i[n]}}}else{m=SPITFIRE.clone(i)}return m}};SPITFIRE.Object=function(){this.setQualifiedClassName("SPITFIRE.Object")};SPITFIRE.Object.synthesizedProperties=["qualifiedClassName"];SPITFIRE.Object.prototype={init:function(){}};SPITFIRE.Class(SPITFIRE.Object);SPITFIRE.Error=function(a){this.callSuper();this.setMessage(a);this.setName("Error");this.setQualifiedClassName("SPITFIRE.Error")};SPITFIRE.Error.superclass=SPITFIRE.Object;SPITFIRE.Error.synthesizedProperties=["message","name"];SPITFIRE.Error.prototype={toString:function(){return this.getName()+": ["+this.getQualifiedClassName()+'] "'+this.getMessage()+'"'}};SPITFIRE.Class(SPITFIRE.Error);SPITFIRE.Event=function(c,d,b,a){this.setBubbles(b||false);this.setCancelable(a||false);this.setData(d||{});this.setType(c)};SPITFIRE.Event.COMPLETE="complete";SPITFIRE.Event.CHANGE="change";SPITFIRE.Event.synthesizedProperties=["bubbles","cancelable","data","target","type"];SPITFIRE.Event.superclass=SPITFIRE.Object;SPITFIRE.Class(SPITFIRE.Event);SPITFIRE.EventDispatcher=function(){this.callSuper();this.setQualifiedClassName("SPITFIRE.EventDispatcher");this._eventListeners={}};SPITFIRE.EventDispatcher.superclass=SPITFIRE.Object;SPITFIRE.EventDispatcher.prototype={bind:function(b,a){if(!this._eventListeners[b]){this._eventListeners[b]=[]}this._eventListeners[b].push(a)},unbind:function(d,c){for(var b=0,a=this._eventListeners[d].length;b<a;b++){if(this._eventListeners[d][b]==c){this._eventListeners[d].splice(b,1)}}},trigger:function(d){d.setTarget(this);var c=[d];if(this._eventListeners[d.getType()]){for(var b=0,a=this._eventListeners[d.getType()].length;b<a;b++){this._eventListeners[d.getType()][b].apply(this,c)}}}};SPITFIRE.Class(SPITFIRE.EventDispatcher);SPITFIRE.DisplayObject=function(){this.callSuper();this.setQualifiedClassName("SPITFIRE.DisplayObject");this._scaleX=1;this._scaleY=1;this._scale=1;this._placeholderProperties=[];this._z=1};SPITFIRE.DisplayObject.superclass=SPITFIRE.EventDispatcher;SPITFIRE.DisplayObject.synthesizedProperties=["$this","l","t","w","h","scaleX","scaleY","scale","rect","z"];SPITFIRE.DisplayObject.prototype={setL:function(a){this.get$this().css("left",a)},getL:function(){var a=(this.style.left)?parseFloat(this.style.left):parseFloat(this.get$this().css("left"));return a||0},setT:function(a){this.get$this().css("top",a)},getT:function(){var a=(this.style.top)?parseFloat(this.style.top):parseFloat(this.get$this().css("top"));return a||0},getW:function(){return(this._w)?this._w*this._scaleX:this.get$this().width()},setW:function(a){this._w=a;this.get$this().width(this._w*this._scaleX)},getH:function(){return(this._h)?this._h*this._scaleY:this.get$this().height()},setH:function(a){this._h=a;this.get$this().height(this._h*this._scaleY)},getScale:function(){return(this._scaleX==this._scaleY)?this._scaleX:undefined},setScale:function(a){this._scale=a;this.setScaleX(a);this.setScaleY(a)},setScaleX:function(a){this._scaleX=a;this.setW(this._w)},setScaleY:function(a){this._scaleY=a;this.setH(this._h)},getRect:function(){return new SPITFIRE.Rectangle(this.getL(),this.getT(),this.getW(),this.getH())},setRect:function(a){this.setL(a.getX());this.setT(a.getY());this.setW(a.getWidth());this.setH(a.getHeight())},setZ:function(a){this._z=a>>0;this.get$this().css("z-index",this._z)},init:function(){this.set$this($(this))},animate:function(c,b){for(var d in c){if(SPITFIRE.isSynthesizedProperty(d,SPITFIRE.DisplayObject)){var a=d+"AnimationValue";c[a]=c[d];delete c[d];this[a]=this[d]();this._placeholderProperties.push(a)}}if(b.step){this.providedAnimationStep=b.step}b.step=this.animationStep.context(this);if(b.complete){this.providedAnimationComplete=b.complete}b.complete=this.animationComplete.context(this);this.get$this().animate(c,b)},animationStep:function(a,b){var c=/AnimationValue/;if(b.prop.search(c)!=-1){this[b.prop.replace(c,"")](a)}if(this.providedAnimationStep){this.providedAnimationStep(a,b)}},animationComplete:function(){if(this.providedAnimationComplete){this.providedAnimationComplete()}delete this.providedAnimationComplete;delete this.providedAnimationStep;while(this._placeholderProperties.length>0){delete this[this._placeholderProperties[0]];this._placeholderProperties.shift()}},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.DisplayObject);SPITFIRE.Task=function(){this.callSuper();this.setQualifiedClassName("SPITFIRE.Task");this.setProgress(0)};SPITFIRE.Task.superclass=SPITFIRE.EventDispatcher;SPITFIRE.Task.synthesizedProperties=["progress","progressive","name","debug"];SPITFIRE.Task.prototype={start:function(){this.setProgress(0)},complete:function(){this.setProgress(1);this.trigger(new SPITFIRE.Event(SPITFIRE.Event.COMPLETE))},toString:function(){return"["+this.getQualifiedClassName()+" name="+this.getName()+"]"}};SPITFIRE.Class(SPITFIRE.Task);SPITFIRE.TaskManager=function(){this._progressiveTasks=[];this._createdTasks=[];this._tasks=[];this.callSuper();this.qualifiedClassName("SPITFIRE.TaskManager")};SPITFIRE.TaskManager.superclass=SPITFIRE.Task;SPITFIRE.TaskManager.synthesizedProperties=["tasks"];SPITFIRE.TaskManager.prototype={setTasks:function(c){var b,a;for(b=0,a=this._tasks.length;b<a;b+=1){this.removeTask(this.tasks()[b])}this._tasks=[];for(b=0,a=c.length;b<a;b+=1){this.addTask(c[b])}},getProgress:function(){var d=0,c,a;for(c=0,a=this._progressiveTasks.length;c<a;c+=1){var b=this._progressiveTasks[c];d+=b.progress}return d/Math.max(this._progressiveTasks.length,1)},setProgress:function(c){var b,a;for(b=0,a=this._progressiveTasks.length;b<a;b+=1){this._progressiveTasks[b].progress(c)}},setDebug:function(c){this.callSuper(c);var b,a;for(b=0,a=this.tasks().length;b<a;b+=1){this.tasks()[b].debug(c)}},addTask:function(a){if(a){this._tasks.push(a);if(a.progressive()){this._progressiveTasks.push(a)}if(this.debug()){a.debug(this.debug())}this.setProgressive()}return a},addTaskAt:function(a,b){if(a){if(a.progressive()){this._progressiveTasks.push(a);this.progressive(true)}this.tasks().splice(b,0,a);if(this.debug()){a.debug(this.debug())}this.setProgressive()}return a},contains:function(a){return this.tasks().indexOf(a)!=-1},getTaskAt:function(a){return this.tasks()[a]},getTaskByName:function(c){var e,d,a;for(d=0,a=this.tasks().length;d<a;d+=1){var b=this.tasks()[d];if(b.name()==c){e=b;break}}return e},getTaskIndex:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}return this.tasks().indexOf(a)},removeTask:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}var b=this.getTaskIndex(a);if(b!=-1){this.removeTaskAt(b)}this.setProgressive();return a},removeTaskAt:function(c){var b=this.getTaskAt(c);this.tasks().splice(c,1);var a=this._progressiveTasks.indexOf(b);if(a!=-1){this._progressiveTasks.splice(a,1)}this.setProgressive();return b},setTaskIndex:function(a,b){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied task must be a child of the caller.")}var c=this.getTaskIndex(a);this.tasks().splice(b,0,this.tasks()[c]);this.tasks().splice(c,1)},swapTasksAt:function(c,b){var a=this.tasks()[c];this.tasks()[c]=this.tasks()[b];this.tasks()[b]=a},setProgressive:function(){this._progressive=(this._progressiveTasks.length>0)},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.TaskManager);SPITFIRE.ModelEvent=function(c,d,b,a){this.callSuper(c,d,b,a)};SPITFIRE.ModelEvent.DATA_UPDATE="dataUpdate";SPITFIRE.ModelEvent.superclass=SPITFIRE.Event;SPITFIRE.Class(SPITFIRE.ModelEvent);SPITFIRE.StateEvent=function(c,d,b,a){this.callSuper(c,d,b,a)};SPITFIRE.StateEvent.CHILD_STATE_CHANGE="childStateChange";SPITFIRE.StateEvent.STATE_CHANGE="stateChange";SPITFIRE.StateEvent.STATE_ACTIVATED="stateActivated";SPITFIRE.StateEvent.superclass=SPITFIRE.Event;SPITFIRE.Class(SPITFIRE.StateEvent);SPITFIRE.StateManagerEvent=function(c,e,b,a,d){this.callSuper(c,e,b,a);this.setState(d);this.setQualifiedClassName("SPITFIRE.StateManagerEvent")};SPITFIRE.StateManagerEvent.LOAD_IN_START="loadInStart";SPITFIRE.StateManagerEvent.LOAD_IN_COMPLETE="loadInComplete";SPITFIRE.StateManagerEvent.TRANSITION_IN_START="transitionInStart";SPITFIRE.StateManagerEvent.TRANSITION_IN_COMPLETE="transitionInComplete";SPITFIRE.StateManagerEvent.LOAD_OUT_START="loadOutStart";SPITFIRE.StateManagerEvent.LOAD_OUT_COMPLETE="loadOutComplete";SPITFIRE.StateManagerEvent.TRANSITION_OUT_START="transitionOutStart";SPITFIRE.StateManagerEvent.TRANSITION_OUT_COMPLETE="transitionOutComplete";SPITFIRE.StateManagerEvent.TRANSITION_IN_STATE_COMPLETE="transitionInStateComplete";SPITFIRE.StateManagerEvent.TRANSITION_OUT_STATE_COMPLETE="transitionOutStateComplete";SPITFIRE.StateManagerEvent.LOAD_IN_STATE_COMPLETE="loadInStateComplete";SPITFIRE.StateManagerEvent.LOAD_OUT_STATE_COMPLETE="loadOutStateComplete";SPITFIRE.StateManagerEvent.DEEPLINK="deeplink";SPITFIRE.StateManagerEvent.superclass=SPITFIRE.Event;SPITFIRE.StateManagerEvent.synthesizedProperties=["state"];SPITFIRE.Class(SPITFIRE.StateManagerEvent);SPITFIRE.TimerEvent=function(c,d,b,a){this.callSuper(c,d,b,a);this.setQualifiedClassName("SPITFIRE.TimerEvent")};SPITFIRE.TimerEvent.TIMER="timer";SPITFIRE.TimerEvent.TIMER_COMPLETE="timerComplete";SPITFIRE.TimerEvent.superclass=SPITFIRE.Event;SPITFIRE.Class(SPITFIRE.TimerEvent);SPITFIRE.Point=function(a,b){this.callSuper();this.setQualifiedClassName("SPITFIRE.Point");this.x=a;this.y=b};SPITFIRE.Point.superclass=SPITFIRE.Object;SPITFIRE.Point.prototype={toString:function(){return"["+this.getQualifiedClassName()+"] x:"+this.x+" y:"+this.y}};SPITFIRE.Class(SPITFIRE.Point);SPITFIRE.Rectangle=function(b,d,c,a){this.callSuper();this.qualifiedClassName("SPITFIRE.Rectangle");this.setX(b);this.setY(d);this.setWidth(c);this.setHeight(a)};SPITFIRE.Rectangle.superclass=SPITFIRE.Object;SPITFIRE.Rectangle.synthesizedProperties=["x","y","width","height","top","left","right","bottom","size","bottomRight","topLeft"];SPITFIRE.Rectangle.prototype={setTop:function(a){throw new SPITFIRE.Error("read-only: cannot set top property")},getTop:function(){return this.getY()},setLeft:function(a){throw new SPITFIRE.Error("read-only: cannot set left property")},getLeft:function(){return this.getX()},setRight:function(a){throw new SPITFIRE.Error("read-only: cannot set right property")},getRight:function(){return this.getX()+this.getWidth()},setBottom:function(a){throw new SPITFIRE.Error("read-only: cannot set bottom property")},getBottom:function(){return this.getY()+this.getHeight()},setSize:function(a){throw new SPITFIRE.Error("read-only: cannot set size property")},getSize:function(){return new SPITFIRE.Point(this.getWidth(),this.getHeight())},setTopLeft:function(a){throw new SPITFIRE.Error("read-only: cannot set topLeft property")},getTopLeft:function(){return new SPITFIRE.Point(this.getTop(),this.getLeft())},setBottomRight:function(a){throw new SPITFIRE.Error("read-only: cannot set bottomRight property")},getBottomRight:function(){return new SPITFIRE.Point(this.getBottom(),this.getRight())},clone:function(){return new SPITFIRE.Rectangle(this.getX(),this.getY(),this.getWidth(),this.getHeight())},toString:function(){return"["+this.getQualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.Rectangle);SPITFIRE.Percent=function(a,b){this.callSuper();a=b||0;b=b||true;if(b){this.setDecimalPercentage(a)}else{this.setPercentage(a)}};SPITFIRE.Percent.superclass=SPITFIRE.Object;SPITFIRE.synthesizedProperties=["percentage","decimalPercentage"];SPITFIRE.prototype={getPercentage:function(){return 100*this._percent},setPercentage:function(a){this._percent=a*0.01},getDecimalPercentage:function(){return this._percent},setDecimalPercentage:function(a){this._percent=a},equals:function(a){return this.getDecimalPercentage()==a.getDecimalPercentage()},clone:function(){return new SPITFIRE.Percent(this.getDecimalPercentage())},valueOf:function(){return this.getDecimalPercentage()},toString:function(){return this.getDecimalPercentage().toString()}};SPITFIRE.Class(SPITFIRE.Percent);SPITFIRE.Model=function(){this.callSuper();this.setQualifiedClassName("SPITFIRE.Model")};SPITFIRE.Model.superclass=SPITFIRE.EventDispatcher;SPITFIRE.Model.synthesizedProperties=["data"];SPITFIRE.Model.prototype={setData:function(a){this._data=a;this.trigger(new SPITFIRE.ModelEvent(SPITFIRE.ModelEvent.DATA_UPDATE))},toString:function(){return"["+this.getQualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.Model);SPITFIRE.Redirect=function(a,b){this.callSuper();this.setQualifiedClassName("SPITFIRE.Redirect");this.setLocation(a);this.setNewLocation(b)};SPITFIRE.Redirect.superclass=SPITFIRE.Object;SPITFIRE.Redirect.synthesizedProperties=["location","newLocation"];SPITFIRE.Class(SPITFIRE.Redirect);SPITFIRE.State=function(a){this.callSuper();this.setName(a);this._children=[];this.setQualifiedClassName("SPITFIRE.State")};SPITFIRE.State.superclass=SPITFIRE.EventDispatcher;SPITFIRE.State.synthesizedProperties=["root","children","stateManager","parent","name","title","description","defaultChild","selectedChild","activatedChild","selectedChildIndex","selected","index","stateLocation","selectable","pageViewName","numChildren","transitionIn","transitionOut","loadIn","loadOut","activated","childClass"];SPITFIRE.State.prototype={setRoot:function(c){this._root=c;for(var b=0,a=this._children.length;b<a;b+=1){this._children[b].setRoot(this._root)}},setStateManager:function(c){this._stateManager=c;for(var b=0,a=this._children.length;b<a;b+=1){this._children[b].setStateManager(this.stateManager())}},setChildren:function(c){for(var b=0,a=this._children.length;b<a;b+=1){this.removeChild(this._children[b])}this._children=[];for(b=0,a=c.length;b<a;b++){this.addChild(c[b])}},setSelectedChild:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}this._selectedChild=a},getActivatedChild:function(){var c,b,a;for(b=0,a=this._children.length;b<a;b+=1){child=this._children[b];if(child.activated){c=child;break}}return c},getNumChildren:function(){return this._children.length},getSelectedChildIndex:function(){var a;if(this._selectedChild){a=this.getChildIndex(this._selectedChild)}return a},setSelectedChildIndex:function(a){var b=this.getChildAt(a);this.setSelectedChild(b)},setSelected:function(a){if(a!=this.selected()){this._selected=a;this.trigger(new SPITFIRE.StateEvent(SPITFIRE.StateEvent.STATE_CHANGE))}},getIndex:function(){return this.getParent().getChildIndex(this)},getStateLocation:function(){var d=[],f=this,c="",e,a,b;while(f){d.push(f);f=f.getParent()}d.reverse();for(e=0,a=d.length;e<a;e+=1){b=d[e];c+=b.getName();if(b!=d[a-1]){c+="/"}}return c},childChangeHandler:function(a){var b=a.getTarget();if(b.getSelected()){this._selectedChild=b}else{if(b==this._selectedChild){this._selectedChild=undefined}}this.trigger(new SPITFIRE.StateEvent(SPITFIRE.StateEvent.CHILD_STATE_CHANGE))},addChild:function(a){a.setParent(this);a.setStateManager(this.getStateManager());a.setRoot(this._root);this._children.push(a);a.bind(SPITFIRE.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this))},addChildAt:function(b,a){b.setParent(this);b.setStateManager(this.getStateManager());b.setRoot(this._root);this._children.splice(a,0,b);b.bind(SPITFIRE.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this));return b},contains:function(a){return this._children.indexOf(a)!=-1},getChildAt:function(a){return this._children[a]},getChildByName:function(b){var d,c,a,e;for(c=0,a=this._children.length;c<a;c+=1){e=this._children[c];if(e.getName()==b){d=e;break}}return d},getChildIndex:function(a){if(!this.contains(a)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}return this._children.indexOf(a)},removeChild:function(b){if(!this.contains(b)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}var a=this.getChildIndex(b),b;if(a!=-1){b=this.removeChildAt(a)}return b},removeChildAt:function(a){var b=this.getChildAt(a);b.unbind(SPITFIRE.StateEvent.STATE_CHANGE,this.childChangeHandler.context(this));this._children.splice(a,1);return b},setChildIndex:function(c,a){if(!this.contains(c)){throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}var b=this.getChildIndex(c);this._children.splice(a,0,this._children[b]);this._children.splice(b,1)},swapChildrenAt:function(c,b){var a=this._children[c];this._children[c]=this._children[b];this._children[b]=a},setSelectedChildByName:function(b){var d,c,a,e;for(c=0,a=this._children.length;c<a;c+=1){e=this._children[c];if(e.getName()==b){d=e;break}}if(d){this.setSelectedChild(d)}else{throw new SPITFIRE.Error("The supplied child must be a child of the caller.")}},browse:function(){this.stateManager().location(this.stateLocation())},browsePreviousSibling:function(){var a=this.index-1;if(a<0){a=this.getParent().getChildren().length-1}this.getParent().getChildAt(a).browse()},browseNextSibling:function(){var a=index+1;if(a>this.getParent().getChildren().length-1){a=0}this.getParent().getChildAt(a).browse()},browsePreviousChild:function(){var a=this.getSelectedChildIndex()-1;if(a<0){a=this._children.length-1}this.getChildAt(a).browse()},browseNextChild:function(){var a=this.getSelectedChildIndex()+1;if(a>this._children.length-1){a=0}this.getChildAt(a).browse()},getChildFromPath:function(e){var c=this,b,a;if(e.length>0){var d=e.split("/");for(b=0,a=d.length;b<a;b+=1){c=c.getChildByName(d[b])}}return c},createChildByName:function(b){if(!this.childClass()){throw new SPITFIRE.Error(this+": no child class defined")}var a=new this.getChildClass();a.setName(b);this.addChild(a);return a},toString:function(){return"[State name="+this.getName()+" title="+this.getTitle()+" className="+this.getQualifiedClassName()+" defaultChild="+this.getDefaultChild()+"]"}};SPITFIRE.Class(SPITFIRE.State);SPITFIRE.StateManager=function(b,a){this.callSuper();this.setRoot(a);this.setQualifiedClassName("SPITFIRE.StateManager");this.setName(b||this.getQualifiedClassName()+~~(Math.random()*100000));this.setPageViewType(SPITFIRE.StateManager.PAGE_VIEW_LOCATION);this._progressTimer=new SPITFIRE.Timer(33);this._progressTimer.bind(SPITFIRE.TimerEvent.TIMER,this.taskManagerProgressHandler.context(this));this._transitionInPath;this._transitionWasInterrupted;this._isInTransition;this._transitions;this._currentTransition;this._redirects=[]};SPITFIRE.StateManager.PAGE_VIEW_LOCATION="pageViewLocation";SPITFIRE.StateManager.PAGE_VIEW_NAME="pageViewName";SPITFIRE.StateManager.superclass=SPITFIRE.EventDispatcher;SPITFIRE.StateManager.synthesizedProperties=["root","deepLinking","tree","startLocation","location","activeStates","taskManager","preloader","selectedStates","debug","trackViewPages","pageViewType","redirects","name"];SPITFIRE.StateManager.prototype={setDeepLinking:function(a){this._deepLinking=a;if(this.getDeepLinking()){this.getDeepLinking().change(this.deepLinkingChangeHandler.context(this))}},setTree:function(a){this._tree=a;a.setStateManager(this);a.setRoot(this.root())},getLocation:function(){var c=this.getSelectedStates(),e="",d,a;for(d=0,a=c.length;d<a;d+=1){var b=c[d];e+=b.getName();if(b!=c[c.length-1]){e+="/"}}return e},setLocation:function(c){if(this.getDeepLinking()){var e=c.split("/");e.shift();var d="/"+e.join("/");this.getDeepLinking().value(d)}else{var a=c.split("/");a.shift();var b=this.getTree();if(a.length>0){b=b.getChildFromPath(a.join("/"))}this._transitionInPath=b.getStateLocation();this.checkIfInTransition()}},getSelectedStates:function(){var a=[],b;if(this.getTree().getSelected()){b=this.getTree()}while(b){a.push(b);b=b.getSelectedChild()}return a},deepLinkingChangeHandler:function(a){var b=this.getDeepLinking().value();if(b==""||b=="/"){this._transitionInPath=this.getTree().getStateLocation()}else{this._transitionInPath=this.getTree().getName()+b}this.checkIfInTransition()},taskManagerProgressHandler:function(b){var a=this.getTaskManager().getProgress();if(this.getDebug()){log(this.getName()+" totalProgress = "+a)}if(isNaN(a)){a=0}if(typeof this.getPreloader()!=="undefined"){this.getPreloader().setProgress(a)}},transitionInCompleteHandler:function(a){if(this.getTrackPageViews()){var b;switch(this.getPageViewType()){case SPITFIRE.StateManager.PAGE_VIEW_LOCATION:b=this.getLocation();break;case SPITFIRE.StateManager.PAGE_VIEW_NAME:b=this.getLocation();break}}},taskManagerCompleteHandler:function(a){this.getTaskManager().unbind(SPITFIRE.Event.COMPLETE,this.taskManagerCompleteHandler.context(this));if(this.getTaskManager().getProgressive()){this.taskManagerProgressHandler();this._progressTimer.stop()}this.trigger(new SPITFIRE.Event(this._currentTransition.transitionName()+"Complete"));this._currentTransition=null;if(this._transitions.length>0){this.startTransition()}else{this._transitions=null;this._isInTransition=false;if(this._transitionWasInterrupted){this.startTransitions()}}},init:function(){if(this.getDeepLinking()){if(this.getDeepLinking().value()!="/"){this.deepLinkingChangeHandler()}else{if(this.getStartLocation()){this.location(this.getStartLocation())}else{this._transitionInPath=this.getTree().getStateLocation();this.checkIfInTransition()}}}else{if(this.getStartLocation()){this.location(this.getStartLocation())}else{this._transitionInPath=this.getTree().getStateLocation();this.checkIfInTransition()}}},checkIfInTransition:function(){if(this._isInTransition){this._transitionWasInterrupted=true}else{this.startTransitions()}},startTransitions:function(){this._transitionWasInterrupted=false;this._isInTransition=false;this._transitionInPath=this.checkRedirect(this._transitionInPath);var c=this._transitionInPath.split("/");var k=[];if(this.getLocation().length>0){k=this.getLocation().split("/")}var d=0,e,g,h,l,f,b;for(e=0,g=k.length;e<g;e+=1){h=k.slice(0,e+1);l=h.join("/");f=c.slice(0,e+1);b=f.join("/");if(l==b){d+=1}}this._transitions=[];var a=[];for(e=k.length-1;e>=d;e-=1){h=k.slice(0,e+1);a.push(h.join("/"))}this.deactivateStates(a);this._transitions.push(new SPITFIRE.TransitionProperties(a.slice(),"loadOut",false));this._transitions.push(new SPITFIRE.TransitionProperties(a.slice(),"transitionOut",false));var j=[];for(e=d,g=c.length;e<g;e+=1){f=c.slice(0,e+1);j.push(f.join("/"))}j=this.activateStates(j);if(j.length==0){j=this.checkForDefaultStates(this._transitionInPath)}this._transitions.push(new SPITFIRE.TransitionProperties(j.slice(),"loadIn",false));this._transitions.push(new SPITFIRE.TransitionProperties(j.slice(),"transitionIn",false));this.startTransition()},deactivateStates:function(c){var g,h;for(g=0,h=c.length;g<h;g+=1){var k=c[g];var d=k.split("/");d.shift();var a=this.getTree();if(d.length>0){var f,e;for(f=0,e=d.length;f<e;f+=1){var b=a;a=b.getChildByName(d[f])}}a.activated(false)}},activateStates:function(c){var e=[],h,k;this._activeStates=[];for(h=0,k=c.length;h<k;h+=1){var m=c[h];var d=m.split("/");d.shift();var a=this.getTree();if(d.length>0){var g,f;for(g=0,f=d.length;g<f;g+=1){var b=a;a=b.getChildByName(d[g]);if(!a){a=b.createChildByName(d[g])}}}a.setActivated(true);this.getActiveStates().push(a);e.push(a.getStateLocation());if(a.getStateLocation()==c[c.length-1]){var l=a.getChildByName(a.defaultChild());while(l){l.setActivated(true);this.getActiveStates().push(l);e.push(l.getStateLocation());l=l.getChildByName(l.getDefaultChild())}}}return e},checkForDefaultStates:function(g){var h=[];var f=g.split("/");f.shift();var e=this.getTree();if(f.length>0){var c,a;for(c=0,a=f.length;c<a;c+=1){var d=e;e=d.getChildByName(f[c])}}var b=e.getChildByName(e.defaultChild);while(b){b.setActivated(true);this.getActiveStates().push(b);h.push(b.getStateLocation());b=b.getChildByName(b.getDefaultChild())}return h},startTransition:function(){this._currentTransition=this._transitions.shift();this.trigger(new SPITFIRE.Event(this._currentTransition.getTransitionName()+"Start"));this.setTaskManager(new SPITFIRE.SequentialTask());this.getTaskManager().setName(this._currentTransition.getTransitionName());if(this.getDebug()){this.getTaskManager().setDebug(this.getDebug())}this.getTaskManager().bind(SPITFIRE.Event.COMPLETE,this.taskManagerCompleteHandler.context(this));var d,a;for(d=0,a=this._currentTransition.getLocations().length;d<a;d+=1){var g=this._currentTransition.getLocations()[d];var f=g.split("/");f.shift();var e=this.getTree();if(f.length>0){e=e.getChildFromPath(f.join("/"))}var c=e[this._currentTransition.getTransitionName()]();if(c){this.getTaskManager().addTask(c)}var b;if(this._currentTransition.getTransitionName()=="transitionIn"){b=true}if(this._currentTransition.getTransitionName()=="transitionOut"){b=false}this.getTaskManager().addTask(new SPITFIRE.PropertyTask(e,"selected",b))}if(this.getTaskManager().getProgress()==1){this.getTaskManager().getProgressive(false)}if(this.getTaskManager().getProgressive()){if(this.getPreloader()){this.getTaskManager().addTaskAt(new SPITFIRE.PropertyTask(this.getPreloader(),"progress",0),0);this.getTaskManager().addTaskAt(this.getPreloader().getTransitionIn(),1);this.getTaskManager().addTask(this.getPreloader().getTransitionOut())}this.getTaskManager().setProgress(0);this._progressTimer.start()}this.getTaskManager().start()},addRedirect:function(a,b){this.removeRedirect(a);this.redirects.push(new SPITFIRE.Redirect(a,b))},removeRedirect:function(b){var d=[];var c,a;for(c=0,a=this.getRedirects().length;c<a;c+=1){var e=this.getRedirects()[c];if(e.getLocation()!=b){d.push(e)}}this.setRedirects(d)},checkRedirect:function(c){var b,a;for(b=0,a=this.getRedirects().length;b<a;b+=1){var d=this.getRedirects()[b];if(c==d.getLocation()){c=d.getNewLocation()}}return c},toString:function(){return"[StateManager name="+this.getName()+" className = "+this.getQualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.StateManager);SPITFIRE.TransitionProperties=function(a,b,c){this.callSuper();this.locations(a);this.transitionName(b);this.showPreloader(c)};SPITFIRE.TransitionProperties.superclass=SPITFIRE.Object;SPITFIRE.TransitionProperties.synthesizedProperties=["locations","transitionName","showPreloader","currentState"];SPITFIRE.TransitionProperties.prototype={toString:function(){return this.transitionName()}};SPITFIRE.Class(SPITFIRE.TransitionProperties);SPITFIRE.FunctionTask=function(c,d){this.callSuper();this.setQualifiedClassName("SPITFIRE.FunctionTask");this.setMethod(d);this.setContext(c);this.setArgs([]);var b,a;for(b=2,a=arguments.length;b<a;b+=1){this.getArgs().push(arguments[b])}};SPITFIRE.FunctionTask.superclass=SPITFIRE.Task;SPITFIRE.FunctionTask.synthesizedProperties=["context","method","args"];SPITFIRE.FunctionTask.prototype={start:function(){this.getMethod().apply(this.getContext(),this.getArgs());this.complete()},toString:function(){return"["+this.getQualifiedClassName()+"] function:"+this.getMethod()._name}};SPITFIRE.Class(SPITFIRE.FunctionTask);SPITFIRE.JQueryAjaxTask=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.JQueryAjaxTask");this.url(a);this.settings(b)};SPITFIRE.JQueryAjaxTask.superclass=SPITFIRE.Task;SPITFIRE.JQueryAjaxTask.synthesizedProperties=["url","settings","content"];SPITFIRE.JQueryAjaxTask.prototype={ajaxSuccessHandler:function(b,c,a){this.content(b);this.complete()},ajaxErrorHandler:function(a,c,b){if(this.debug()){log(this+" Error: could not load this file. textStatus="+c+" errorThrown="+b)}this.complete()},ajaxComplete:function(a,b){if(this.debug()){log(this+" Complete: textStatus="+b)}},start:function(){$.ajax(this.url(),this.settings()).success(this.ajaxSuccessHandler.context(this)).error(this.ajaxErrorHandler.context(this)).complete(this.ajaxComplete.context(this))},toString:function(){return"["+this.qualifiedClassName()+"] url:"+this.url()}};SPITFIRE.Class(SPITFIRE.JQueryAjaxTask);SPITFIRE.JQueryEffectTask=function(c,b){this.callSuper();this.qualifiedClassName("SPITFIRE.JQueryEffectTask");var a=SPITFIRE.slice(arguments,2,arguments.length-1);if(!SPITFIRE.isFunction(c[b])){throw new SPITFIRE.Error("target does not support this effect")}this.target(c);this.effect(b);this.args(a)};SPITFIRE.JQueryEffectTask.superclass=SPITFIRE.Task;SPITFIRE.JQueryEffectTask.synthesizedProperties=["target","effect","args"];SPITFIRE.JQueryEffectTask.prototype={effectCompleteHandler:function(){this.complete()},start:function(){this.args().push($.proxy(this.effectCompleteHandler,this));this.target()[this.effect()].apply(this.target(),this.args())},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.JQueryEffectTask);SPITFIRE.JQueryGetJSONTask=function(a,b){this.callSuper();this.qualifiedClassName("SPITFIRE.JQueryGetJSONTask");this.url(a);this.data(b)};SPITFIRE.JQueryGetJSONTask.superclass=SPITFIRE.Task;SPITFIRE.JQueryGetJSONTask.synthesizedProperties=["url","data","content"];SPITFIRE.JQueryGetJSONTask.prototype={jsonHandler:function(a,b){switch(b){case"success":this.content(a);break}this.complete()},start:function(){$.getJSON(this.url(),this.jsonHandler.context(this))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.JQueryGetJSONTask);SPITFIRE.JQueryImageLoaderTask=function(a){this.callSuper();this.qualifiedClassName("SPITFIRE.JQueryImageLoaderTask");this.url(a);this.content(new Image());this.$content($(this.content()));this.$content().load(this.completeHandler.context(this)).error(this.errorHandler.context(this))};SPITFIRE.JQueryImageLoaderTask.superclass=SPITFIRE.Task;SPITFIRE.JQueryImageLoaderTask.synthesizedProperties=["url","content","$content"];SPITFIRE.JQueryImageLoaderTask.prototype={completeHandler:function(){this.complete()},errorHandler:function(){if(this.debug()){log(this+" Error: could not load this file.")}this.complete()},start:function(){this.$content().attr("src",this.url())},toString:function(){return"["+this.qualifiedClassName()+" url="+this.url()+"]"}};SPITFIRE.Class(SPITFIRE.JQueryImageLoaderTask);SPITFIRE.JQueryLoadTask=function(b,a){this.callSuper();this.qualifiedClassName("SPITFIRE.JQueryLoadTask");if(!b){throw new SPITFIRE.Error("a valid url must be specified")}this.url(b);this.$target(a||$("body"))};SPITFIRE.JQueryLoadTask.superclass=SPITFIRE.Task;SPITFIRE.JQueryLoadTask.synthesizedProperties=["url","$target"];SPITFIRE.JQueryLoadTask.prototype={loadHandler:function(b,a,c){if(a=="error"){log(this+" Error: could not load this file")}this.complete()},start:function(){this.$target().load(this.url(),this.loadHandler.context(this))},toString:function(){return"["+this.qualifiedClassName()+" url="+this.url()+"]"}};SPITFIRE.Class(SPITFIRE.JQueryLoadTask);SPITFIRE.ParallelTask=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.ParallelTask");if(arguments.length>0){this.tasks(arguments)}};SPITFIRE.ParallelTask.superclass=SPITFIRE.TaskManager;SPITFIRE.ParallelTask.prototype={taskCompleteHandler:function(b){var a=b.target();if(this.debug()){log("taskComplete "+a)}a.unbind(SPITFIRE.Event.COMPLETE,this.taskCompleteHandler.context(this));this._createdTasks.push(a);if(this._createdTasks.length==this.tasks().length){if(this.debug()){log("tasksComplete "+this)}this.complete()}},start:function(){this._createdTasks=[];if(this.tasks().length>0){var c,a;for(c=0,a=this.tasks().length;c<a;c+=1){var b=this.tasks()[c];b.bind(SPITFIRE.Event.COMPLETE,this.taskCompleteHandler.context(this));if(this.debug()){log("taskStart "+b)}b.start()}}else{this.complete()}},toString:function(){return"["+this.qualifiedClassName()+" name="+this.name()+"]"}};SPITFIRE.Class(SPITFIRE.ParallelTask);SPITFIRE.PropertyTask=function(c,b,a){this.callSuper();this.qualifiedClassName("SPITFIRE.PropertyTask");this.target(c);this.property(b);this.value(a)};SPITFIRE.PropertyTask.superclass=SPITFIRE.Task;SPITFIRE.PropertyTask.synthesizedProperties=["target","property","value"];SPITFIRE.PropertyTask.prototype={start:function(){this.target()[this.property()](this.value());this.complete()},toString:function(){return"["+this.qualifiedClassName()+" target="+this.target()+" property="+this.property()+" value="+this.value()+"]"}};SPITFIRE.Class(SPITFIRE.PropertyTask);SPITFIRE.SequentialTask=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.SequentialTask");if(arguments.length>0){this.tasks(arguments)}};SPITFIRE.SequentialTask.superclass=SPITFIRE.TaskManager;SPITFIRE.SequentialTask.synthesizedProperties=[];SPITFIRE.SequentialTask.prototype={taskCompleteHandler:function(b){var a=b.target();if(this.debug()){log("taskComplete "+a)}a.unbind(SPITFIRE.Event.COMPLETE,this.taskCompleteHandler.context(this));this._createdTasks.push(a);if(this._createdTasks.length==this.tasks().length){this.complete()}else{this.createTask()}},start:function(){this._createdTasks=[];if(this.tasks().length>0){this.createTask()}else{this.complete()}},createTask:function(){var b=this._createdTasks.length;var a=this.tasks()[b];a.bind(SPITFIRE.Event.COMPLETE,this.taskCompleteHandler.context(this));if(this.debug()){log("taskStart "+a)}a.start()},toString:function(){return"["+this.qualifiedClassName()+" name="+this.name()+"]"}};SPITFIRE.Class(SPITFIRE.SequentialTask);SPITFIRE.UIButton=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.UIButton")};SPITFIRE.UIButton.superclass=SPITFIRE.DisplayObject;SPITFIRE.UIButton.synthesizedProperties=[];SPITFIRE.UIButton.prototype={mouseOverHandler:function(a){this.$this().addClass("sf-over")},mouseOutHandler:function(a){this.$this().removeClass("sf-over")},clickHandler:function(a){},mouseUpHandler:function(a){this.$this().removeClass("sf-down")},mouseDownHandler:function(a){this.$this().addClass("sf-down")},init:function(){this.callSuper();SPITFIRE.addListener(this,"click","clickHandler");SPITFIRE.addListener(this,"mouseover","mouseOverHandler");SPITFIRE.addListener(this,"mouseout","mouseOutHandler");SPITFIRE.addListener(this,"mouseup","mouseUpHandler");SPITFIRE.addListener(this,"mousedown","mouseDownHandler")},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.UIButton);SPITFIRE.UICarousel=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.UICarousel");this._items=[];this._itemHeight=200;this._neighbors=2;this._itemDistance=160;this._speed=500;this._scaleRatio=0.3;this._positionIndex=0};SPITFIRE.UICarousel.superclass=SPITFIRE.DisplayObject;SPITFIRE.UICarousel.synthesizedProperties=["items","center","itemHeight","neighbors","itemDistance","positionIndex","startX","centerIndex","speed","scaleRatio"];SPITFIRE.UICarousel.prototype={setPositionIndex:function(j){var e=this._positionIndex;var k=this.items()[e].carouselIndex()-this.items()[j].carouselIndex();var b,f,n,l,h,c,d,a,g,m=(this.items().length*0.5>>0)+1;for(b=0,f=this.items().length;b<f;b+=1){n=this.items()[b];l=n.carouselIndex()+k;l=(l<0||l>=f)?(l<0)?l+f:l-f:l;n.carouselIndex(l);n.carousel(this);h=n.carouselIndex()*this.itemDistance()+this.startX();c=Math.abs(this.centerIndex()-l);g=(m-c)*25;d=(c<=this.neighbors())?1:0;a=1-c*this.scaleRatio();n.animate({l:h,t:this.center().y,opacity:d,scale:a,z:g},{duration:this._speed*Math.abs(k)})}this._positionIndex=j;this.trigger(new SPITFIRE.Event(SPITFIRE.Event.CHANGE))},init:function(){this.callSuper();this.center(new SPITFIRE.Point(~~(this.w()*0.5),~~(this.h()*0.5)));this.$this().addClass("sf-carousel");var b=this.getElementsByTagName("div");var c,a,d;for(c=0,a=b.length;c<a;c+=1){d=b[c];d.index(c);d.itemHeight(this.itemHeight());this.items().push(d)}this.positionItems();this.positionIndex(0)},positionItems:function(){var c=this._positionIndex+1,l=(this._positionIndex-1>=0)?this._positionIndex-1:this.items().length-1,d=l,b=c,g=this.center().x,e=this.center().y,n=this.items()[this._positionIndex],a=g+this.itemDistance(),f=g-this.itemDistance(),i,m,k=0,h=Math.ceil((this.items().length-1)*0.5),j;this.centerIndex(Math.floor(this.items().length*0.5));n.l(g);n.t(e);n.$this().css("opacity",1);n.carouselIndex(this.centerIndex());while(k<h){k++;j=(k>this.neighbors())?0:1;i=this.items()[c];if(i){i.l(a);i.t(e);i.carouselIndex(this.centerIndex()+k);i.$this().css("opacity",j);a+=this.itemDistance();c++;if(c>=this.items().length){c=0}}m=this.items()[l];if(m){m.l(f);m.t(e);m.carouselIndex(this.centerIndex()-k);m.$this().css("opacity",j);f-=this.itemDistance();l--;if(l<0){l=this.items().length-1}}}this.startX(m.l())},previous:function(){var a=this.positionIndex()-1;a=(a<0)?this.items().length-1:a;this.positionIndex(a)},next:function(){var a=this.positionIndex()+1;a=(a>=this.items().length)?0:a;this.positionIndex(a)},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.UICarousel);SPITFIRE.UICarouselItem=function(){this.callSuper();this.qualifiedClassName("SPITFIRE.UICarouselItem");this._itemHeight=100;this._isImgInitialized=false};SPITFIRE.UICarouselItem.superclass=SPITFIRE.DisplayObject;SPITFIRE.UICarouselItem.synthesizedProperties=["index","carouselIndex","carousel","img","itemHeight","itemWidth","isImgInitialized"];SPITFIRE.UICarouselItem.prototype={setItemHeight:function(a){this._itemHeight=a;if(this.img().complete){this.imageLoadedHandler()}},setScale:function(a){this._scale=a;if(this.img().complete){this.imageLoadedHandler()}},getScale:function(){return this._scale},imageLoadedHandler:function(){SPITFIRE.removeListener(this.img(),"load",this.imageLoadedHandler);this.initImage();this.resizeImage();this.scaleAndPositionImage()},init:function(){this.callSuper();this.img(this.getElementsByTagName("img")[0]);if(!this.img().complete){SPITFIRE.addListener(this.img(),"load",this.imageLoadedHandler,this)}else{this.imageLoadedHandler()}},initImage:function(){if(this._isImgInitialized){return}this.img().w(this.img().width);this.img().h(this.img().height);this._isImgInitialized=true},resizeImage:function(){var b=new SPITFIRE.Rectangle(0,0,this.img().w(),this.img().h());var a=SPITFIRE.RatioUtils.scaleWidth(b,this._itemHeight,true);this.img().w(a.width());this.img().h(a.height())},scaleAndPositionImage:function(){this.img().scale(this._scale);this.img().l(~~(-this.img().w()*0.5));this.img().t(~~(-this.img().h()*0.5))},toString:function(){return"["+this.qualifiedClassName()+"]"}};SPITFIRE.Class(SPITFIRE.UICarouselItem);SPITFIRE.ArrayUtils={};SPITFIRE.ArrayUtils.getItemByKeys=function(f,b){var d=-1,e,a;while(++d<f.length){e=f[d];a=true;for(var c in b){if(!e.hasOwnProperty(c)||e[c]!=b[c]){a=false}}if(a){return e}}return undefined};SPITFIRE.ArrayUtils.getItemsByKeys=function(g,b){var e=[],d=-1,f,a;while(++d<g.length){f=g[d];a=true;for(var c in b){if(!f.hasOwnProperty(c)||f[c]!=b[c]){a=false}}if(a){e.push(f)}}return e};SPITFIRE.ArrayUtils.getItemByAnyKey=function(e,a){var c=-1,d;while(++c<e.length){d=e[c];for(var b in a){if(!d.hasOwnProperty(b)||d[b]!=a[b]){return d}}}return undefined};SPITFIRE.ArrayUtils.getItemsByAnyKey=function(g,b){var e=[],d=-1,f,a;while(++d<g.length){f=g[d];a=true;for(var c in b){if(!f.hasOwnProperty(c)||f[c]!=b[c]){e.push(f);break}}}return e};SPITFIRE.ArrayUtils.getItemByKey=function(f,d,b){var c,a,e;for(var c=0,a=f.length;c<a;c+=1){e=f[c];if(e.hasOwnProperty(d)){if(e[d]==b){return e}}}return undefined};SPITFIRE.ArrayUtils.getItemsByKey=function(g,e,b){var d,a,f,c=[];for(var d=0,a=g.length;d<a;d+=1){f=g[d];if(f.hasOwnProperty(e)){if(f[e]==b){c.push(f)}}}return c};SPITFIRE.RatioUtils=SPITFIRE.RatioUtils||{widthToHeight:function(a){return a.width()/a.height()},heightToWidth:function(a){return a.height()/a.width()},scale:function(b,a,c){c=c||true;return SPITFIRE.RatioUtils._defineRect(b,b.width()*a.decimalPercentage(),b.height()*a.decimalPercentage(),c)},scaleWidth:function(b,a,c){c=c||true;return SPITFIRE.RatioUtils._defineRect(b,a*SPITFIRE.RatioUtils.widthToHeight(b),a,c)},scaleHeight:function(a,b,c){c=c||true;return SPITFIRE.RatioUtils._defineRect(a,b,b*SPITFIRE.RatioUtils.heightToWidth(a),c)},scaleToFill:function(b,c,d){d=d||true;var a=SPITFIRE.RatioUtils.scaleHeight(b,c.width(),d);if(a.height()<c.height()){a=SPITFIRE.RatioUtils.scaleWidth(b,c.height(),d)}return a},scaleToFit:function(b,c,d){d=d||true;var a=SPITFIRE.RatioUtils.scaleHeight(b,c.width(),d);if(a.height()>c.height()){a=SPITFIRE.RatioUtils.scaleWidth(b,c.height(),d)}return a},_defineRect:function(c,d,a,e){var b=c.clone();b.width(e?~~(d):d);b.height(e?~~(a):a);return b}};SPITFIRE.Timer=function(b,a){this.callSuper();this.delay(b);this.repeatCount(a||0);this.qualifiedClassName("SPITFIRE.Timer");this._interval;this._currentCount=0};SPITFIRE.Timer.superclass=SPITFIRE.EventDispatcher;SPITFIRE.Timer.synthesizedProperties=["currentCount","delay","repeatCount","running"];SPITFIRE.Timer.prototype={setRunning:function(a){throw new SPITFIRE.Error("running is read-only")},setCurrentCount:function(a){throw new SPITFIRE.Error("currentCount is read-only")},reset:function(){this.stop();this._currentCount=0},start:function(){if(this._interval){return}if(this.repeatCount()&&this.currentCount()>=this.repeatCount()){return}this._interval=setTimeout(this.tick.context(this),this.delay())},stop:function(){if(this._interval){log("clear: "+this._interval);clearTimeout(this._interval)}this._interval=undefined},tick:function(){this._currentCount+=1;if(this.repeatCount()&&this._currentCount>=this.repeatCount()){this.trigger(new SPITFIRE.TimerEvent(SPITFIRE.TimerEvent.TIMER_COMPLETE));this.reset();return}this._interval=setTimeout(this.tick.context(this),this.delay());this.trigger(new SPITFIRE.TimerEvent(SPITFIRE.TimerEvent.TIMER))}};SPITFIRE.Class(SPITFIRE.Timer);